"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3424],{6198:function(e,n,t){var a=t(2412),s=t(3733),r=t(9940),i=t(2876),l=t(4226),o=t(2167),c=t(8751);n.Z=e=>{let{open:n,children:t,action:d,handleClose:u,isLoading:m,actionText:h}=e;return(0,a.jsx)(s.R,{isOpen:n,onOpenChange:!m&&u||void 0,classNames:{backdrop:"z-[20000]",wrapper:"z-[20000]"},children:(0,a.jsx)(r.A,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.k,{className:"flex flex-col gap-1",children:"Confirmation"}),(0,a.jsx)(l.I,{children:t}),(0,a.jsxs)(o.R,{children:[(0,a.jsx)(c.A,{color:"primary",variant:"light",onPress:e,isLoading:m,children:"Cancel"}),(0,a.jsx)(c.A,{color:"primary",onPress:d,isLoading:m,children:h||"Confirm"})]})]})})})}},7449:function(e,n,t){t.d(n,{Z:function(){return d}});var a=t(2412),s=t(3390),r=t(9646),i=t(4690),l=t(1402),o=(e,n)=>{(0,l.useEffect)(()=>{let t=t=>{let a=null==e?void 0:e.current;!a||(null==a?void 0:a.contains(t.target))||n(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}},[e,n])},c=t(1225),d=e=>{let{open:n,x:t,y:d,handleCloseMenu:u,items:m}=e,h=(0,l.useRef)(null);return o(h,u),n&&(0,a.jsx)(c.E.div,{className:"w-full max-w-[260px] border-small px-1 py-0.5 rounded-small bg-background/40 backdrop-blur-lg border-default-200 absolute z-[20000]",style:{left:t,top:d},ref:h,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.08},children:(0,a.jsx)(s.X,{variant:"flat","aria-label":"Listbox menu with sections",items:m,children:m.map(e=>{let{category:n,items:t}=e;return(0,a.jsx)(r.y,{title:n,children:t.map(e=>{let{key:n,description:t,icon:s,color:r,onClick:l}=e;return(0,a.jsx)(i.R,{description:(0,a.jsx)("span",{className:"text-foreground-700",children:t}),startContent:(0,a.jsx)(s,{}),color:r||"default",onClick:()=>{l&&l(),u()},children:n},n)})},n)})})})}},3424:function(e,n,t){t.d(n,{f:function(){return q},default:function(){return B}});var a=t(2412),s=t(1358),r=t(8134),i=t(7296),l=t(9688),o=t(6574),c=t(1365),d=t(8882),u=t(3425),m=t(4345),h=t(7864),x=t(6805),p=t(4690),j=t(1740),v=t(6044),g=t(165),y=t(5979),f=t(5522),b=t(8751),w=t(2155),C=t(889),T=t(1402),E=t(8786),z=t(6418),N=t(1946),P=t(2160),Z=t(5440);let D=(0,P.Ue)(e=>({action:null,setAction:n=>e({action:n}),isLoading:!1,setIsLoading:n=>e({isLoading:n}),details:null,setDetails:n=>e({details:n}),reset:()=>e({action:null,isLoading:!1,details:null})}));Z.z.object({reason:Z.z.string()}),Z.z.object({reason:Z.z.string(),duration:Z.z.string(),type:N.P}),Z.z.object({comment:Z.z.string()}),Z.z.object({reason:Z.z.string(),duration:Z.z.string(),type:N.P}),Z.z.enum(["unmute","remute","comment","edit","delete"]);var S=t(8601),_=t(6198),M=t(4643),L=t(7449),R=t(4837),A=t(1920),k=t(5414),I=t(5939),U=t(4093),Y=t(3733),X=t(9940),F=t(2876),V=t(4226),G=t(2167),O=t(52),W=e=>{let{open:n,setOpen:t,mutate:s}=e,[r,i]=(0,T.useState)(!1),l=async()=>{if(!r){i(!0);try{await (0,O.Z)("/api/mutes",{method:"POST",data:o.values}),await s(),k.Am.success("Succesfully muted player!"),t(!1)}catch(t){var e;let n=(null==t?void 0:null===(e=t.response)||void 0===e?void 0:e.data)||(null==t?void 0:t.message);console.error(t),k.Am.error("Failed to create mute!\n".concat(n||t))}i(!1)}},o=(0,I.c)({initialValues:{player_steamid:"",reason:"",duration:"",comment:"",type:"MUTE"},validate:(0,U.F)(N.Z)});return(0,a.jsx)(Y.R,{isOpen:n,onOpenChange:r?void 0:t,children:(0,a.jsx)(X.A,{children:e=>(0,a.jsxs)("form",{onSubmit:o.onSubmit(l),children:[(0,a.jsx)(F.k,{className:"flex flex-col gap-1",children:"Create new mute"}),(0,a.jsxs)(V.I,{children:[(0,a.jsx)(C.Y,{...o.getInputProps("player_steamid"),errorMessage:o.errors.player_steamid,label:"Player Steam64 / SteamId / Profile URL",placeholder:"7656XXXXXX",variant:"bordered",isDisabled:r,autoFocus:!0}),(0,a.jsx)(x.g,{label:"Type",placeholder:"Select the mute type",selectedKeys:[o.values.type],onChange:e=>o.setValues({type:e.target.value}),isDisabled:r,disallowEmptySelection:!0,children:q.map(e=>(0,a.jsx)(p.R,{value:e.value,children:e.name},e.value))}),(0,a.jsx)(C.Y,{...o.getInputProps("reason"),errorMessage:o.errors.reason,label:"Reason (min 3 characters)",placeholder:"Cheating / Griefing / Toxicity / etc.",variant:"bordered",isDisabled:r}),(0,a.jsx)(C.Y,{...o.getInputProps("duration"),errorMessage:o.errors.duration,label:"Duration in minutes",placeholder:"for example, 60",description:"0 for permanent",variant:"bordered",type:"number",isDisabled:r}),(0,a.jsx)(C.Y,{...o.getInputProps("comment"),errorMessage:o.errors.comment,label:"Comment (optional)",variant:"bordered",isDisabled:r}),(0,a.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,a.jsxs)("span",{children:["The mute will start now ",(0,a.jsxs)("b",{children:["(",(0,S.Z)(),")"]})]}),(0,a.jsxs)("span",{children:["and will end at"," ",(0,a.jsx)("b",{children:"0"===o.values.duration?(0,a.jsx)("b",{className:"text-red-700",children:"Permanent"}):(0,S.Z)(new Date().getTime()+6e4*Number(o.values.duration))})]})]})]}),(0,a.jsxs)(G.R,{children:[(0,a.jsx)(b.A,{color:"danger",variant:"flat",onPress:e,isDisabled:r,children:"Cancel"}),(0,a.jsx)(b.A,{color:"primary",type:"submit",isLoading:r,children:"Mute player"})]})]})})})},J=e=>{switch(e){case"ACTIVE":return(0,a.jsx)(z.z,{color:"danger",size:"sm",variant:"flat",radius:"sm",children:"Active"});case"EXPIRED":return(0,a.jsx)(z.z,{color:"success",size:"sm",variant:"flat",radius:"sm",children:"Expired"});case"UNMUTED":return(0,a.jsx)(z.z,{color:"secondary",size:"sm",variant:"flat",radius:"sm",children:"Removed"});default:return(0,a.jsx)(z.z,{color:"secondary",size:"sm",variant:"flat",radius:"sm",children:"Unknown"})}},H=t(3806),K=t(1281);let q=[{name:"Gag (Chat)",value:"GAG"},{name:"Mute (Voice)",value:"MUTE"},{name:"Silence (Both)",value:"SILENCE"}];var B=e=>{var n;let{type:t}=e,[N,P]=(0,T.useState)(!1),[Z,I]=(0,T.useState)(1),[U,Y]=(0,T.useState)(""),[X]=(0,w.Nr)(U,500),F=10;"/"===(0,y.usePathname)()&&(F=5);let{data:V,isLoading:G,mutate:B}=(0,K.ZP)("/api/mutes?page=".concat(Z,"&rows=").concat(F,"&query=").concat(X),A.Z,{keepPreviousData:!0}),Q=(0,T.useMemo)(()=>(null==V?void 0:V.count)?Math.ceil(V.count/F):0,[null==V?void 0:V.count,F]),{admin:$}=(0,R.ZP)(),{x:ee,y:en,open:et,handleCloseMenu:ea,handleOpen:es,info:er}=(0,M.Z)(),ei=D(e=>e.action),el=D(e=>e.setAction),eo=D(e=>e.details),ec=D(e=>e.setDetails),ed=D(e=>e.isLoading),eu=D(e=>e.setIsLoading),em=D(e=>e.reset),eh=async()=>{if(ei&&!ed&&er){eu(!0);try{await O.Z.post("/api/mutes/".concat(er.id),{action:ei,details:eo}),await B(),em(),k.ZP.success("Player ".concat(ei,"ed successfully"))}catch(e){k.ZP.error("Error ".concat(ei," player"))}eu(!1)}},ex=(e,n)=>{var t,s,r;switch(n){case"player_name":return(0,a.jsx)(H.default,{href:"https://steamcommunity.com/profiles/".concat(e.player_steamid),target:"_blank",passHref:!0,children:(0,a.jsx)(E.z,{avatarProps:{radius:"lg",src:e.player_avatar||""},name:e.player_name,children:null===(t=e.player_name)||void 0===t?void 0:t.slice(0,10)})});case"status":return J(e.status);case"reason":return e.reason.length>10?(0,a.jsx)(f.e,{content:e.reason,showArrow:!0,children:(0,a.jsx)("div",{className:"text-xs font-light",children:e.reason.slice(0,10)})}):(0,a.jsx)("div",{className:"text-xs font-light",children:e.reason});case"unmute_reason":return e.unmute_reason&&e.unmute_reason.length>10?(0,a.jsx)(f.e,{content:e.unmute_reason,showArrow:!0,children:(0,a.jsx)("div",{className:"text-xs font-light",children:null===(s=e.unmute_reason)||void 0===s?void 0:s.slice(0,10)})}):(0,a.jsx)("div",{className:"text-xs font-light",children:e.unmute_reason});case"type":return(0,a.jsx)(z.z,{color:"secondary",size:"sm",variant:"flat",radius:"sm",children:e.type});case"duration":return(0,a.jsx)(z.z,{color:"primary",size:"sm",variant:"flat",radius:"sm",children:0===e.duration?"Permanent":"".concat(e.duration," minutes")});case"admin_name":return e.admin_name?"Console"===e.admin_name?(0,a.jsx)(z.z,{color:"danger",size:"sm",variant:"flat",radius:"sm",children:"Console"}):(0,a.jsx)(H.default,{href:"https://steamcommunity.com/profiles/".concat(e.admin_steamid),target:"_blank",passHref:!0,children:(0,a.jsx)(E.z,{avatarProps:{radius:"lg",src:e.admin_avatar||""},name:e.admin_name,children:e.admin_name})}):(0,a.jsx)(a.Fragment,{children:"-"});case"timeLeft":if(0===e.duration)return(0,a.jsx)(z.z,{color:"danger",size:"sm",variant:"flat",radius:"sm",children:"Permanent"});if("UNMUTED"===e.status||"EXPIRED"===e.status)return(0,a.jsx)(v.W,{color:"success",value:100,isStriped:!0});let i=new Date,l=new Date(e.created),o=new Date(e.ends),c=Math.round((i.getTime()-l.getTime())/(o.getTime()-l.getTime())*100)||0,d=Math.round((o.getTime()-i.getTime())/6e4),u=c<50?"warning":c>=100?"success":"primary";return d>0?(0,a.jsx)(f.e,{content:"".concat(d," minutes left"),color:u,showArrow:!0,children:(0,a.jsx)(v.W,{color:u,value:c,isStriped:!0})}):(0,a.jsx)(v.W,{color:u,value:c,isStriped:!0});case"comment":return e.comment?e.comment.length>10?(0,a.jsx)(f.e,{content:e.comment,showArrow:!0,children:(0,a.jsx)("div",{className:"text-xs font-light",children:null===(r=e.comment)||void 0===r?void 0:r.slice(0,10)})}):(0,a.jsx)("div",{className:"text-xs font-light",children:e.comment}):(0,a.jsx)(a.Fragment,{children:"-"});case"created":return(0,S.Z)(e.created);default:return(0,a.jsx)(a.Fragment,{})}},ep=(0,a.jsx)(a.Fragment,{});switch(t){case"MANAGE":ep=(0,a.jsxs)(s.J,{children:[(0,a.jsx)(r.j,{children:"Player"},"player_name"),(0,a.jsx)(r.j,{children:"Status"},"status"),(0,a.jsx)(r.j,{children:"Admin"},"admin_name"),(0,a.jsx)(r.j,{children:"Type"},"type"),(0,a.jsx)(r.j,{children:"Reason"},"reason"),(0,a.jsx)(r.j,{children:"Remove Reason"},"unmute_reason"),(0,a.jsx)(r.j,{children:"Duration"},"duration"),(0,a.jsx)(r.j,{children:"Time left"},"timeLeft"),(0,a.jsx)(r.j,{children:"Comment"},"comment")]});break;case"SMALL":ep=(0,a.jsxs)(s.J,{children:[(0,a.jsx)(r.j,{children:"Player"},"player_name"),(0,a.jsx)(r.j,{children:"Status"},"status"),(0,a.jsx)(r.j,{children:"Type"},"type"),(0,a.jsx)(r.j,{children:"Reason"},"reason"),(0,a.jsx)(r.j,{children:"Duration"},"duration"),(0,a.jsx)(r.j,{children:"Time left"},"timeLeft")]});break;case"NORMAL":ep=(0,a.jsxs)(s.J,{children:[(0,a.jsx)(r.j,{children:"Player"},"player_name"),(0,a.jsx)(r.j,{children:"Status"},"status"),(0,a.jsx)(r.j,{children:"Admin"},"admin_name"),(0,a.jsx)(r.j,{children:"Type"},"type"),(0,a.jsx)(r.j,{children:"Reason"},"reason"),(0,a.jsx)(r.j,{children:"Remove Reason"},"unmute_reason"),(0,a.jsx)(r.j,{children:"Duration"},"duration"),(0,a.jsx)(r.j,{children:"Time left"},"timeLeft")]})}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.b,{topContent:(0,a.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,a.jsxs)("div",{className:"text-start",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Mutes"}),(0,a.jsxs)("code",{className:"text-sm font-normal",children:["total: ",(null==V?void 0:V.count)||""]})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(f.e,{content:"Search for player name, steamid, IP, reason, etc.",closeDelay:50,color:"primary",delay:400,children:(0,a.jsx)(C.Y,{label:"Search",labelPlacement:"outside-left",value:U,onValueChange:Y,size:"sm",classNames:{mainWrapper:"h-fit",base:"h-fit"},isClearable:!0})}),$&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(b.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>P(!0),children:[(0,a.jsx)(d.Z,{}),"New mute"]}),(0,a.jsx)(W,{open:N,setOpen:P,mutate:B})]})]})]}),bottomContent:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex w-full justify-center",children:(0,a.jsx)(j.g,{color:"primary",page:Z,total:Q,onChange:e=>I(e),size:"sm",isCompact:!0,showControls:!0,showShadow:!0})}),$&&"MANAGE"===t&&(0,a.jsx)("span",{className:"text-sm",children:"Tip, your can right click on a player row for more actions"})]}),children:[ep,(0,a.jsx)(l.y,{items:null!==(n=null==V?void 0:V.results)&&void 0!==n?n:[],loadingContent:(0,a.jsx)(g.c,{}),loadingState:G?"loading":"idle",children:e=>(0,a.jsx)(o.g,{onContextMenu:n=>$&&es&&es(n,e)||void 0,children:n=>(0,a.jsx)(c.X,{children:ex(e,n)})},e.id)})]}),$&&(0,a.jsx)(L.Z,{open:et,x:ee,y:en,handleCloseMenu:ea,items:[{category:"Mute Actions",items:[{key:"Comment",description:"Write a comment on this mute, this will be visible to other admins",icon:u.Z,color:"default",onClick:()=>{el("comment"),ec({comment:(null==er?void 0:er.comment)||""})}},{key:(null==er?void 0:er.status)==="UNMUTED"||(null==er?void 0:er.status)==="EXPIRED"?"Re-mute":"Remove Mute (shorten)",description:(null==er?void 0:er.status)==="UNMUTED"||(null==er?void 0:er.status)==="EXPIRED"?"Re-mute the player":"Remove the player mute (shorten the duration)",icon:m.Z,color:"default",onClick:()=>{(null==er?void 0:er.status)==="UNMUTED"||(null==er?void 0:er.status)==="EXPIRED"?(el("remute"),ec({reason:"",duration:"0",type:"MUTE"})):(el("unmute"),ec({reason:""}))}},{key:"Edit Mute",description:"Edit the mute duration or reason",icon:u.Z,color:"primary",onClick:()=>{el("edit"),ec({reason:(null==er?void 0:er.reason)||"",duration:(null==er?void 0:er.duration.toString())||"0",type:(null==er?void 0:er.type)||"MUTE"})}},{key:"Delete Mute",description:"Delete the mute from the database (permanent action)",icon:h.Z,color:"danger",onClick:()=>{el("delete")}}]}]}),$&&(0,a.jsxs)(_.Z,{open:"comment"===ei,handleClose:em,action:eh,isLoading:ed,actionText:"Save",children:[(0,a.jsx)("div",{children:"Write a comment on this mute, this will be visible to other admins"}),(0,a.jsx)(C.Y,{label:"Comment",value:(null==eo?void 0:eo.comment)||"",onValueChange:e=>ec({comment:e})})]}),$&&(0,a.jsxs)(_.Z,{open:"unmute"===ei,handleClose:em,action:eh,isLoading:ed,actionText:"Unmute",children:[(0,a.jsx)("div",{children:"You sure you want to unmute the user?"}),(0,a.jsx)(C.Y,{label:"Reason",value:(null==eo?void 0:eo.reason)||"",onValueChange:e=>ec({reason:e})})]}),$&&(0,a.jsxs)(_.Z,{open:"remute"===ei,handleClose:em,action:eh,isLoading:ed,actionText:"Remute",children:[(0,a.jsx)("div",{children:"You sure you want to remute the user?"}),(0,a.jsx)(C.Y,{label:"Reason",value:(null==eo?void 0:eo.reason)||"",onValueChange:e=>ec({...eo,reason:e})}),(0,a.jsx)(x.g,{label:"Type",placeholder:"Select the mute type",selectedKeys:[null==eo?void 0:eo.type],onChange:e=>ec({...eo,type:e.target.value}),disallowEmptySelection:!0,children:q.map(e=>(0,a.jsx)(p.R,{value:e.value,children:e.name},e.value))}),(0,a.jsx)(C.Y,{label:"Time (in minutes)",type:"number",value:(null==eo?void 0:eo.duration)||"",onValueChange:e=>ec({...eo,duration:e}),description:"Time in minutes, 0 = Permanent mute"}),(0,a.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,a.jsxs)("span",{children:["The mute will start again at ",(0,a.jsx)("b",{children:(0,S.Z)()})]}),(0,a.jsxs)("span",{children:["the mute will end at"," ",(0,a.jsx)("b",{children:(null==eo?void 0:eo.duration)==="0"?(0,a.jsx)("b",{className:"text-red-700",children:"Permanent"}):(0,S.Z)(new Date().getTime()+6e4*Number(null==eo?void 0:eo.duration))})]})]})]}),$&&(0,a.jsxs)(_.Z,{open:"edit"===ei,handleClose:em,action:eh,isLoading:ed,actionText:"Edit",children:[(0,a.jsx)("div",{children:"This will replace the mute duration or reason"}),(0,a.jsx)(C.Y,{label:"Mute Reason",value:null==eo?void 0:eo.reason,onValueChange:e=>ec({...eo,reason:e})}),(0,a.jsx)(x.g,{label:"Type",placeholder:"Select the mute type",selectedKeys:[null==eo?void 0:eo.type],onChange:e=>ec({...eo,type:e.target.value}),disallowEmptySelection:!0,children:q.map(e=>(0,a.jsx)(p.R,{value:e.value,children:e.name},e.value))}),(0,a.jsx)(C.Y,{label:"Mute Time (in minutes)",type:"number",value:(null==eo?void 0:eo.duration)||"",onValueChange:e=>ec({...eo,duration:e}),description:"Time in minutes, this will be added to the current duration, 0 = Permanent mute (will replace the duration)"}),(0,a.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,a.jsxs)("span",{children:["The mute started at ",(0,a.jsx)("b",{children:(0,S.Z)(null==er?void 0:er.created)})]}),(0,a.jsxs)("span",{children:["After the edit, the mute will end at"," ",(0,a.jsx)("b",{children:(null==eo?void 0:eo.duration)==="0"?(0,a.jsx)("b",{className:"text-red-700",children:"Permanent"}):(0,S.Z)(new Date((null==er?void 0:er.created)||"").getTime()+6e4*Number(null==eo?void 0:eo.duration))})]})]})]}),$&&(0,a.jsx)(_.Z,{open:"delete"===ei,handleClose:em,action:eh,isLoading:ed,actionText:"Delete",children:(0,a.jsx)("div",{children:"Are you sure you want to delete the mute? this action is permanent and cannot be undone"})})]})}},1920:function(e,n,t){var a=t(52);n.Z=e=>a.Z.get(e).then(e=>e.data)},8601:function(e,n){n.Z=e=>{let n=e?new Date(e):new Date;return n.toLocaleDateString()+" - "+n.toLocaleTimeString()}},4837:function(e,n,t){t.d(n,{hY:function(){return l},jc:function(){return o}});var a=t(5414),s=t(1281),r=t(1920),i=t(52);let l=async()=>{await (0,i.Z)("/api/auth/logout"),await (0,s.JG)("/api/auth"),a.Am.success("Logged out successfully")},o=()=>{let e=window.innerWidth/2-300,n=window.innerHeight/2-400,t=window.open("/api/auth/login/","","toolbar=no, location=no, directories=no, status=no, menubar=no, \n		  scrollbars=no, resizable=yes, copyhistory=no, width=".concat(600,", \n		  height=").concat(800,", top=").concat(n,", left=").concat(e)),r=setInterval(async()=>{t&&t.closed&&(await (0,s.JG)("/api/auth"),a.Am.success("Logged in successfully!"),clearInterval(r))},1e3)};n.ZP=()=>{let{data:e,isLoading:n,error:t}=(0,s.ZP)("/api/auth",r.Z);return e&&e.admin&&e.admin.group&&(e.admin.flags=e.admin.group.flags,e.admin.immunity=e.admin.group.immunity),{user:t||!e?null:e.user,admin:t||!e?null:e.admin,isLoading:n}}},4643:function(e,n,t){var a=t(1402);n.Z=()=>{let[e,n]=(0,a.useState)({open:!1,x:0,y:0,info:void 0});return{x:e.x,y:e.y,open:e.open,handleCloseMenu:()=>{n({...e,open:!1})},handleOpen:(e,t)=>{e.preventDefault();let{pageX:a,pageY:s}=e;n({open:!0,x:a,y:s,info:t})},info:e.info}}},1946:function(e,n,t){t.d(n,{P:function(){return s}});var a=t(5440);let s=a.z.enum(["GAG","MUTE","SILENCE"]),r=a.z.object({player_steamid:a.z.string(),reason:a.z.string().min(3),duration:a.z.string(),comment:a.z.string().optional(),type:s});n.Z=r}}]);