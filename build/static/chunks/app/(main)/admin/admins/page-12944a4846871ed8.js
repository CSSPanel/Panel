(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3853],{19074:function(e,s,i){Promise.resolve().then(i.bind(i,70412))},90679:function(e,s,i){"use strict";var a=i(12412),n=i(80165),r=i(65979),t=i(11402),l=i(74837);s.default=e=>{let{children:s,flags:i}=e,{admin:d,isLoading:o}=(0,l.ZP)(),c=(0,r.useRouter)();return(0,t.useEffect)(()=>{if(!o&&(!d||i.length>0&&!i.some(e=>{var s;return null===(s=d.flags)||void 0===s?void 0:s.includes(e)})))return c.push("/")},[d,o,c,i]),o?(0,a.jsx)(n.c,{}):d?(0,a.jsx)(a.Fragment,{children:s}):(0,a.jsx)(a.Fragment,{children:"No Access"})}},54773:function(e,s,i){"use strict";i.d(s,{r:function(){return d}});var a=i(12412),n=i(65979),r=i(28365),t=i(13327),l=i(74837);s.default=()=>{let e=(0,n.usePathname)(),s=(0,n.useRouter)(),{admin:i}=(0,l.ZP)(),o=(null==i?void 0:i.flags)||[],c=d.filter(e=>e.permissions.some(e=>o.includes(e)));return(0,a.jsx)(r.n,{"aria-label":"Admin-tabs",selectedKey:e,onSelectionChange:e=>s.push(e),items:c,children:e=>(0,a.jsx)(t.r,{title:e.title},e.path)})};let d=[{path:"/admin",title:"Statistics",permissions:["@web/root","@web/logs","@css/root","@web/stats"]},{path:"/admin/modules",title:"Modules",permissions:["@web/root","@css/root"]},{path:"/admin/admins",title:"Manage Admins",permissions:["@web/root","@css/root","@web/admins"]},{path:"/admin/servers",title:"Manage Servers",permissions:["@web/root","@css/root","@web/servers","@web/rcon"]},{path:"/admin/bans",title:"Manage Bans",permissions:["@web/root","@css/root","@web/bans"]},{path:"/admin/mutes",title:"Manage Mutes",permissions:["@web/root","@css/root","@web/mutes"]},{path:"/admin/logs",title:"Logs",permissions:["@web/root","@css/root","@web/logs"]},{path:"/admin/settings",title:"Panel Settings",permissions:["@web/root","@css/root"]}]},70412:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return ec}});var a=i(12412),n=i(97284),r=i(35508),t=i(40593),l=i(38751),d=i(15220),o=(0,i(61319).tv)({base:["px-2","py-1","h-fit","font-mono","font-normal","inline-block","whitespace-nowrap"],variants:{color:{default:d.J.flat.default,primary:d.J.flat.primary,secondary:d.J.flat.secondary,success:d.J.flat.success,warning:d.J.flat.warning,danger:d.J.flat.danger},size:{sm:"text-small",md:"text-medium",lg:"text-large"},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"}},defaultVariants:{color:"default",size:"sm",radius:"sm"}}),c=i(7923),m=i(11402),u=(0,c.Gp)((e,s)=>{let{Component:i,children:n,getCodeProps:r}=function(e){let[s,i]=(0,c.oe)(e,o.variantKeys),{as:a,children:n,className:r,...t}=s,l=(0,m.useMemo)(()=>o({...i,className:r}),[...Object.values(i),r]);return{Component:a||"code",children:n,getCodeProps:()=>({className:l,...t})}}({...e});return(0,a.jsx)(i,{ref:s,...r(),children:n})});u.displayName="NextUI.Code";var p=i(98882),g=i(28365),h=i(13327),f=i(65979),v=i(54773),x=i(77296),j=i(21358),y=i(18134),b=i(59688),w=i(36574),S=i(11365),A=i(20172),F=i(7864),z=i(73162),N=i(75522),_=i(80165),C=i(65414),E=i(66418),M=i(1281),W=i(41920),Z=i(79476),D=i(74837),P=i(72160);let k=(0,P.Ue)(e=>({open:!1,setOpen:s=>e({open:s,edit:null}),edit:null,setEdit:s=>e({edit:s,open:!0}),delete:null,setDelete:s=>e({delete:s}),servers:[],setServers:s=>e({servers:s})}));var G=i(93806),O=i(30052),I=()=>{var e;let s=k(e=>e.setServers),{admin:i}=(0,D.ZP)(),{data:n,isLoading:r}=(0,M.ZP)("/api/admin/admins",W.Z);(0,m.useEffect)(()=>{var e;n&&s(null!==(e=null==n?void 0:n.servers)&&void 0!==e?e:[])},[n,s]);let t=k(e=>e.setEdit),d=k(e=>e.delete),o=k(e=>e.setDelete),c=async()=>{if(d){try{await (0,O.Z)("/api/admin/admins/".concat(d.id),{method:"DELETE"}),C.Am.success("Succesfully deleted admin!"),await (0,M.JG)("/api/admin/admins"),await (0,M.JG)("/api/admin/groups")}catch(s){var e;C.Am.error(null!==(e=s.response.data)&&void 0!==e?e:"Failed to delete admin!")}o(null)}},u=!r&&(null==n?void 0:n.servers)&&(null==n?void 0:n.admins)?"idle":"loading",p=(e,s)=>{switch(s){case"id":return(0,a.jsx)(E.z,{variant:"flat",size:"sm",children:e.id});case"group":{let s="string"==typeof e.flags&&e.flags.startsWith("#")?null==n?void 0:n.groups.find(s=>s.id===e.flags):null;return s?(0,a.jsxs)(a.Fragment,{children:[s.name," (",s.id,")"]}):(0,a.jsx)(a.Fragment,{children:"-"})}case"server":{var r;if(!e.server_id)return(0,a.jsx)(a.Fragment,{children:"ALL"});if(e.server_id.length>1){let s=e.server_id.map(e=>{var s;return null==n?void 0:null===(s=n.servers.find(s=>s.id.toString()===e))||void 0===s?void 0:s.hostname});return(0,a.jsx)(N.e,{content:s.join("\n"),className:"whitespace-pre-wrap",closeDelay:50,color:"primary",children:(0,a.jsxs)(E.z,{variant:"flat",size:"sm",color:"primary",children:[s.length," Servers"]})})}let s=null==n?void 0:n.servers.find(s=>s.id==(e.server_id||0));return(0,a.jsx)(E.z,{variant:"flat",size:"sm",children:null!==(r=null==s?void 0:s.hostname)&&void 0!==r?r:"Unknown"})}case"player_name":return(0,a.jsx)("div",{children:e.player_name});case"player_steamid":return(0,a.jsx)(G.default,{href:"https://steamcommunity.com/profiles/".concat(e[s]),target:"_blank",children:e.player_steamid});case"flags":let d="string"==typeof e.flags&&e.flags.startsWith("#")?null==n?void 0:n.groups.find(s=>s.id===e.flags):null,c=d?d.flags:e.flags,m=c&&"object"==typeof c?c.join(", "):c,u=c&&"object"==typeof c?c.join("\n"):m,p="string"==typeof m?m.split(", "):m,g=p.filter(e=>e.startsWith("@web")),h=p.filter(e=>e.startsWith("@css"));return d?(0,a.jsx)(N.e,{content:u,closeDelay:50,color:"secondary",className:"whitespace-pre-wrap",children:(0,a.jsxs)(E.z,{variant:"flat",size:"sm",color:"secondary",children:[p.length," Flags from ",null==d?void 0:d.name]})}):e.flags.length>2?(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[g.length?(0,a.jsx)(N.e,{content:g.join("\n"),closeDelay:50,color:"primary",className:"whitespace-pre-wrap",children:(0,a.jsxs)(E.z,{variant:"flat",size:"sm",color:"primary",children:[g.length," Web Flags"]})}):(0,a.jsx)(a.Fragment,{}),h.length?(0,a.jsx)(N.e,{content:h.join("\n"),closeDelay:50,color:"secondary",className:"whitespace-pre-wrap",children:(0,a.jsxs)(E.z,{variant:"flat",size:"sm",color:"secondary",children:[h.length," Admin Flags"]})}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsx)(E.z,{variant:"flat",size:"sm",children:p.join(", ")});case"immunity":return(0,a.jsx)(E.z,{variant:"flat",size:"sm",children:e.immunity});case"ends":return e.ends?(0,z.Q)(new Date(e.ends)):"Never";case"actions":let f=Number(i.immunity)<Number(e.immunity)&&(null==i?void 0:i.immunity)!=="100";return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(l.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>t(e),isDisabled:f,children:[(0,a.jsx)(A.Z,{size:16}),"Edit Admin"]}),(0,a.jsxs)(l.A,{size:"sm",variant:"flat",color:"danger",onClick:()=>o(e),isDisabled:f,children:[(0,a.jsx)(F.Z,{size:16}),"Delete Admin"]})]});default:return(0,a.jsx)(a.Fragment,{children:"Error!"})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x.b,{children:[(0,a.jsxs)(j.J,{children:[(0,a.jsx)(y.j,{children:"ID"},"id"),(0,a.jsx)(y.j,{children:"Name"},"player_name"),(0,a.jsx)(y.j,{children:"SteamId"},"player_steamid"),(0,a.jsx)(y.j,{children:"Group"},"group"),(0,a.jsx)(y.j,{children:"Servers"},"server"),(0,a.jsx)(y.j,{children:"Immunity"},"immunity"),(0,a.jsx)(y.j,{children:"Flags / Group"},"flags"),(0,a.jsx)(y.j,{children:"Ends"},"ends"),(0,a.jsx)(y.j,{children:"Actions"},"actions")]}),(0,a.jsx)(b.y,{loadingContent:(0,a.jsx)(_.c,{}),loadingState:u,isLoading:"loading"===u,items:null!==(e=null==n?void 0:n.admins)&&void 0!==e?e:[],children:e=>(0,a.jsx)(w.g,{children:s=>(0,a.jsx)(S.X,{children:p(e,s)})})})]}),(0,a.jsx)(Z.Z,{open:!!d,onAction:c,onCancel:()=>o(null),title:"Delete admin",text:(0,a.jsxs)("p",{children:["Are you sure you want to delete: ",(0,a.jsx)("b",{children:null==d?void 0:d.player_name})," admin?"]})})]})},V=i(55939),J=i(64093),L=i(23733),R=i(99940),Y=i(92876),K=i(74226),T=i(82167),U=i(40976),B=i(45746),Q=i(93050),X=i(72558),$=i(10889),H=i(25087),q=i(85440);let ee=[{id:"@css/reservation",description:"Reserved slot access."},{id:"@css/generic",description:"Generic admin."},{id:"@css/kick",description:"Kick other players."},{id:"@css/ban",description:"Ban other players."},{id:"@css/unban",description:"Remove bans."},{id:"@css/vip",description:"General vip status."},{id:"@css/slay",description:"Slay/harm other players."},{id:"@css/changemap",description:"Change the map or major gameplay features."},{id:"@css/cvar",description:"Change most cvars."},{id:"@css/config",description:"Execute config files."},{id:"@css/chat",description:"Special chat privileges."},{id:"@css/vote",description:"Start or create votes."},{id:"@css/password",description:"Set a password on the server."},{id:"@css/rcon",description:"Use RCON commands."},{id:"@css/cheats",description:"Change sv_cheats or use cheating commands."},{id:"@css/root",description:"Magically enables all flags and ignores immunity values."},{id:"@web/root",description:"Web panel root access."},{id:"@web/admins",description:"Manage web admins."},{id:"@web/admingroups",description:"Manage web admin groups."},{id:"@web/bans",description:"Manage bans."},{id:"@web/mutes",description:"Manage mutes."},{id:"@web/logs",description:"View panel logs."},{id:"@web/stats",description:"View server statistics."},{id:"@web/servers",description:"Manage servers."},{id:"@web/rcon",description:"Manage servers via RCON."}],es=ee.map(e=>e.id),ei=q.z.string().refine(e=>es.includes(e)||e.startsWith("#"),{message:"The flag is not valid"}),ea=q.z.object({player_name:q.z.string().min(3).regex(/^[\w\s]+$/),player_steamid:q.z.string().regex(/^7656119\d{10}$/),server_id:q.z.array(q.z.string()).nullable(),flags:q.z.union([q.z.array(ei),ei]),immunity:q.z.string().min(0).max(100)});var en=()=>{var e,s,i;let n=k(e=>e.open),r=k(e=>e.edit),t=k(e=>e.setOpen),d=k(e=>e.servers),{admin:o}=(0,D.ZP)(),[c,u]=(0,m.useState)(!r||!r.server_id),[p,g]=(0,m.useState)(!1),{data:h}=(0,M.ZP)("/api/admin/admins",W.Z),f=async()=>{if(!p){g(!0);try{await (0,O.Z)(r?"/api/admin/admins/".concat(r.id):"/api/admin/admins",{method:r?"PUT":"POST",data:{...v.values,server_id:c?null:v.values.server_id}}),await (0,M.JG)("/api/admin/admins"),C.Am.success(r?"Succesfully edited admin!":"Succesfully created admin!"),t(!1)}catch(e){console.error(e),C.Am.error("Failed to ".concat(r?"edit":"create"," admin!"))}g(!1)}},v=(0,V.c)({initialValues:{player_name:r?r.player_name:"",player_steamid:r?r.player_steamid:"",server_id:r?r.server_id:null,flags:r?r.flags:[],immunity:r?r.immunity:"0"},validate:(0,J.F)(ea)});(0,m.useEffect)(()=>{v.setValues({player_name:r?r.player_name:"",player_steamid:r?r.player_steamid:"",server_id:r?r.server_id:null,flags:r?r.flags:[],immunity:r?r.immunity:"0"}),u(!r||!r.server_id)},[r]);let x="string"==typeof v.values.flags&&v.values.flags.startsWith("#")&&null!==(s=null==h?void 0:h.groups.find(e=>e.id===v.values.flags))&&void 0!==s?s:void 0,j="string"!=typeof v.values.flags?v.values.flags.join(", "):void 0,y=v.values.server_id?v.values.server_id.length>1?v.values.server_id.length:null!==(i=null===(e=d.find(e=>e.id.toString()===v.values.server_id[0]))||void 0===e?void 0:e.hostname)&&void 0!==i?i:"None":"All";return(0,a.jsx)(L.R,{isOpen:n,onOpenChange:p?void 0:t,children:(0,a.jsx)(R.A,{children:e=>{var s,i,n,t;return(0,a.jsxs)("form",{onSubmit:v.onSubmit(f),children:[(0,a.jsx)(Y.k,{className:"flex flex-col gap-1",children:r?"Edit admin":"Create new admin"}),(0,a.jsxs)(K.I,{children:[(0,a.jsx)($.Y,{...v.getInputProps("player_name"),errorMessage:v.errors.player_name,label:"Admin Name",placeholder:"John Doe",variant:"bordered",disabled:p,autoFocus:!0}),(0,a.jsx)($.Y,{...v.getInputProps("player_steamid"),errorMessage:v.errors.player_steamid,label:"SteamId (64)",placeholder:"76561198000000000",type:"text",variant:"bordered",disabled:p}),(0,a.jsx)(H.K,{isSelected:c,onValueChange:u,children:"All Servers"}),(0,a.jsxs)(U.F,{children:[(0,a.jsx)(B.S,{children:(0,a.jsxs)(l.A,{variant:"bordered",isDisabled:c,children:["Servers: ",y]})}),(0,a.jsx)(Q.a,{"aria-label":"Servers",items:d,closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...null!==(s=v.values.server_id)&&void 0!==s?s:[]]),onSelectionChange:e=>v.setFieldValue("server_id",Array.from(e)),disallowEmptySelection:!0,children:e=>(0,a.jsx)(X.W,{id:e.id.toString(),color:"default",children:e.hostname},e.id)})]}),(0,a.jsxs)(U.F,{children:[(0,a.jsx)(B.S,{children:(0,a.jsxs)(l.A,{variant:"bordered",children:["Group: ",(null==x?void 0:x.name)||"unset"]})}),(0,a.jsx)(Q.a,{"aria-label":"Flags",items:null!==(i=null==h?void 0:h.groups)&&void 0!==i?i:[],children:(null==h?void 0:h.groups.map(e=>(0,a.jsxs)(X.W,{id:e.id,color:"default",onClick:()=>v.setValues({flags:e.id}),children:[e.name," ",v.values.flags===e.id&&"(Selected)"]},e.id)))||(0,a.jsx)(a.Fragment,{})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)(U.F,{children:[(0,a.jsx)(B.S,{children:(0,a.jsxs)(l.A,{variant:"bordered",children:["Web Flags:"," ",x?(0,a.jsxs)(a.Fragment,{children:[x.flags.filter(e=>e.startsWith("@web/")).length||0," ","(Group)"]}):(null==j?void 0:j.split(", ").filter(e=>e.startsWith("@web")).length)||0]})}),(0,a.jsx)(Q.a,{"aria-label":"Web Flags",items:ee,closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...null!==(n=v.values.flags)&&void 0!==n?n:[]]),onSelectionChange:e=>v.setFieldValue("flags",Array.from(e).filter(e=>es.includes(e))),disallowEmptySelection:!0,children:ee.filter(e=>e.id.startsWith("@web/")).map(e=>(0,a.jsxs)(X.W,{id:e.id,color:"default",children:[e.id," - ",e.description]},e.id))})]}),(0,a.jsxs)(U.F,{children:[(0,a.jsx)(B.S,{children:(0,a.jsxs)(l.A,{variant:"bordered",children:["Admin Flags:"," ",x?(0,a.jsxs)(a.Fragment,{children:[x.flags.filter(e=>e.startsWith("@css/")).length||0," ","(Group)"]}):(null==j?void 0:j.split(", ").filter(e=>e.startsWith("@css")).length)||0]})}),(0,a.jsx)(Q.a,{"aria-label":"Admin Flags",items:ee,closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...null!==(t=v.values.flags)&&void 0!==t?t:[]]),onSelectionChange:e=>v.setFieldValue("flags",Array.from(e).filter(e=>es.includes(e))),disallowEmptySelection:!0,children:ee.filter(e=>e.id.startsWith("@css/")).map(e=>(0,a.jsxs)(X.W,{id:e.id,color:"default",children:[e.id," - ",e.description]},e.id))})]})]}),(0,a.jsx)("span",{className:"text-xs",children:"You can choose either pre defined group, or flags."}),(0,a.jsx)($.Y,{value:v.values.immunity,onChange:e=>(null==o?void 0:o.immunity)==="100"?v.setFieldValue("immunity",e.target.value):Number(e.target.value)<Number(null==o?void 0:o.immunity)&&Number(e.target.value)>=0&&v.setFieldValue("immunity",e.target.value),errorMessage:v.errors.immunity,label:"Immunity",placeholder:"Example, 99, max of ".concat(Number(null==o?void 0:o.immunity)-1),description:"Max of ".concat(Number(null==o?void 0:o.immunity)-1," (Your immunity - 1)"),type:"number",variant:"bordered",disabled:p})]}),(0,a.jsxs)(T.R,{children:[(0,a.jsx)(l.A,{color:"danger",variant:"flat",onPress:e,disabled:p,children:"Cancel"}),(0,a.jsx)(l.A,{color:"primary",type:"submit",isLoading:p,children:r?"Edit admin":"Create admin"})]})]})}})})};let er=(0,P.Ue)(e=>({open:!1,setOpen:s=>e({open:s,edit:null}),edit:null,setEdit:s=>e({edit:s,open:!0}),delete:null,setDelete:s=>e({delete:s})}));var et=()=>{let{admin:e}=(0,D.ZP)(),{data:s,isLoading:i}=(0,M.ZP)("/api/admin/groups",W.Z),n=er(e=>e.setEdit),r=er(e=>e.delete),t=er(e=>e.setDelete),d=async()=>{if(r){try{await (0,O.Z)("/api/admin/groups/".concat(r.id.replace("#","")),{method:"DELETE"}),C.Am.success("Succesfully deleted group!"),await (0,M.JG)("/api/admin/groups"),await (0,M.JG)("/api/admin/admins")}catch(s){var e;C.Am.error(null!==(e=s.response.data)&&void 0!==e?e:"Failed to delete group!")}t(null)}},o=i||!s?"loading":"idle",c=(s,i)=>{switch(i){case"id":return(0,a.jsx)(E.z,{variant:"flat",size:"sm",children:s.id});case"name":return(0,a.jsx)("div",{children:s.name});case"flags":let r=s.flags,d=r.filter(e=>e.startsWith("@web")),o=r.filter(e=>e.startsWith("@css"));return"string"!=typeof s.flags?s.flags?s.flags.length>2?(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[d.length?(0,a.jsx)(N.e,{content:d.join("\n"),closeDelay:50,color:"primary",className:"whitespace-pre-wrap",children:(0,a.jsxs)(E.z,{variant:"flat",size:"sm",color:"primary",children:[d.length," Web Flags"]})}):(0,a.jsx)(a.Fragment,{}),o.length?(0,a.jsx)(N.e,{content:o.join("\n"),closeDelay:50,color:"secondary",className:"whitespace-pre-wrap",children:(0,a.jsxs)(E.z,{variant:"flat",size:"sm",color:"secondary",children:[o.length," Admin Flags"]})}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsx)(E.z,{variant:"flat",size:"sm",children:s.flags.join(", ")}):"":s.flags;case"immunity":return(0,a.jsx)(E.z,{variant:"flat",size:"sm",children:s.immunity});case"created":return(0,a.jsxs)(a.Fragment,{children:[(0,z.Q)(new Date(s.created||""))," ago"]});case"actions":let c=Number(e.immunity)<Number(s.immunity)&&(null==e?void 0:e.immunity)!=="100";return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(l.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>n(s),isDisabled:c,children:[(0,a.jsx)(A.Z,{size:16}),"Edit Admin Group"]}),(0,a.jsxs)(l.A,{size:"sm",variant:"flat",color:"danger",onClick:()=>t(s),isDisabled:c,children:[(0,a.jsx)(F.Z,{size:16}),"Delete Admin Group"]})]});default:return(0,a.jsx)(a.Fragment,{children:"Error!"})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x.b,{children:[(0,a.jsxs)(j.J,{children:[(0,a.jsx)(y.j,{children:"ID"},"id"),(0,a.jsx)(y.j,{children:"Name"},"name"),(0,a.jsx)(y.j,{children:"Flags"},"flags"),(0,a.jsx)(y.j,{children:"Immunity"},"immunity"),(0,a.jsx)(y.j,{children:"Created"},"created"),(0,a.jsx)(y.j,{children:"Actions"},"actions")]}),(0,a.jsx)(b.y,{loadingContent:(0,a.jsx)(_.c,{}),loadingState:o,isLoading:"loading"===o,items:null!=s?s:[],children:e=>(0,a.jsx)(w.g,{children:s=>(0,a.jsx)(S.X,{children:c(e,s)})})})]}),(0,a.jsx)(Z.Z,{open:!!r,onAction:d,onCancel:()=>t(null),title:"Delete group",text:(0,a.jsxs)("p",{children:["Are you sure you want to delete: ",(0,a.jsx)("b",{children:null==r?void 0:r.name})," group?"]})})]})};let el=q.z.object({id:q.z.string().min(3).refine(e=>e.startsWith("#"),{message:"The id must start with #"}),name:q.z.string().min(3),flags:q.z.array(ei),immunity:q.z.string().min(0).max(100)});var ed=()=>{let e=er(e=>e.open),s=er(e=>e.edit),i=er(e=>e.setOpen),{admin:n}=(0,D.ZP)(),[r,t]=(0,m.useState)(!1),d=async()=>{if(!r){t(!0);try{await (0,O.Z)(s?"/api/admin/groups/".concat(s.id.replace("#","")):"/api/admin/groups",{method:s?"PUT":"POST",data:o.values}),await (0,M.JG)("/api/admin/groups"),await (0,M.JG)("/api/admin/admins"),C.Am.success(s?"Succesfully edited group!":"Succesfully created group!"),i(!1)}catch(e){console.error(e),C.Am.error("Failed to ".concat(s?"edit":"create"," group!"))}t(!1)}},o=(0,V.c)({initialValues:{id:s?s.id:"#",name:s?s.name:"",flags:s?s.flags:["@css/generic"],immunity:s?s.immunity.toString():"0"},validate:(0,J.F)(el)});return(0,m.useEffect)(()=>{o.setValues({id:s?s.id:"#",name:s?s.name:"",flags:s?s.flags:["@css/generic"],immunity:s?s.immunity.toString():"0"})},[s]),(0,m.useEffect)(()=>{o.values.name&&o.setValues({id:"#".concat(o.values.name.toLowerCase().replace(/\s/g,"-"))})},[o.values.name]),(0,a.jsx)(L.R,{isOpen:e,onOpenChange:r?void 0:i,children:(0,a.jsx)(R.A,{children:e=>(0,a.jsxs)("form",{onSubmit:o.onSubmit(d),children:[(0,a.jsx)(Y.k,{className:"flex flex-col gap-1",children:s?"Edit group":"Create new group"}),(0,a.jsxs)(K.I,{children:[(0,a.jsx)($.Y,{...o.getInputProps("name"),errorMessage:o.errors.name,label:"Group Name",placeholder:"Example, Admins",variant:"bordered",disabled:r,autoFocus:!0}),(0,a.jsx)($.Y,{...o.getInputProps("id"),errorMessage:o.errors.id,label:"Group ID",placeholder:"Example, #admins",type:"text",variant:"bordered",disabled:r}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)(U.F,{children:[(0,a.jsx)(B.S,{children:(0,a.jsxs)(l.A,{variant:"bordered",children:["Web Flags: ",o.values.flags.filter(e=>e.startsWith("@web")).length]})}),(0,a.jsx)(Q.a,{"aria-label":"Web Flags",items:ee.filter(e=>e.id.startsWith("@web")),closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...o.values.flags]),onSelectionChange:e=>o.setFieldValue("flags",Array.from(e)),disallowEmptySelection:!0,children:e=>(0,a.jsxs)(X.W,{id:e.id,color:"default",children:[e.id," - ",e.description]},e.id)})]}),(0,a.jsxs)(U.F,{children:[(0,a.jsx)(B.S,{children:(0,a.jsxs)(l.A,{variant:"bordered",children:["Admin Flags: ",o.values.flags.filter(e=>e.startsWith("@css")).length]})}),(0,a.jsx)(Q.a,{"aria-label":"Admin Flags",items:ee.filter(e=>e.id.startsWith("@css")),closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...o.values.flags]),onSelectionChange:e=>o.setFieldValue("flags",Array.from(e)),disallowEmptySelection:!0,children:e=>(0,a.jsxs)(X.W,{id:e.id,color:"default",children:[e.id," - ",e.description]},e.id)})]})]}),(0,a.jsx)($.Y,{value:o.values.immunity,onChange:e=>(null==n?void 0:n.immunity)==="100"?o.setFieldValue("immunity","99"):Number(e.target.value)<Number(null==n?void 0:n.immunity)&&Number(e.target.value)>=0&&o.setFieldValue("immunity",e.target.value),errorMessage:o.errors.immunity,label:"Immunity",placeholder:"Example, 99, max of ".concat(Number(null==n?void 0:n.immunity)-1),description:"Max of ".concat(Number(null==n?void 0:n.immunity)-1," (Your immunity - 1)"),type:"number",variant:"bordered",disabled:r})]}),(0,a.jsxs)(T.R,{children:[(0,a.jsx)(l.A,{color:"danger",variant:"flat",onPress:e,disabled:r,children:"Cancel"}),(0,a.jsx)(l.A,{color:"primary",type:"submit",isLoading:r,children:s?"Edit admin group":"Create admin group"})]})]})})})},eo=i(90679),ec=()=>{let e=k(e=>e.setOpen),s=er(e=>e.setOpen),i=(0,f.usePathname)(),d=v.r.find(e=>e.path===i);return(0,a.jsx)(eo.default,{flags:(null==d?void 0:d.permissions)||[],children:(0,a.jsxs)(g.n,{"aria-label":"Options",children:[(0,a.jsx)(h.r,{title:"Manage Admins",children:(0,a.jsxs)(n.w,{children:[(0,a.jsxs)(r.u,{className:"text-2xl font-medium flex flex-row justify-between",children:["Manage Admins",(0,a.jsxs)(l.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>e(!0),children:[(0,a.jsx)(p.Z,{}),"Create new Admin"]})]}),(0,a.jsx)(t.G,{children:(0,a.jsx)(I,{})}),(0,a.jsx)(en,{})]})},"admins"),(0,a.jsx)(h.r,{title:"Manage Groups",children:(0,a.jsxs)(n.w,{children:[(0,a.jsxs)(r.u,{className:"text-2xl font-medium flex flex-row justify-between",children:["Manage Admin Groups",(0,a.jsxs)(l.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>s(!0),children:[(0,a.jsx)(p.Z,{}),"Create new group"]})]}),(0,a.jsxs)(t.G,{children:[(0,a.jsxs)("p",{className:"text-sm mb-6",children:["Admin groups are used to make pre-defined permissions for admins, you can assign an admin to a group and whenever you change the group permissions, the admin will automatically get the new permissions.",(0,a.jsx)("br",{}),"Note that you can also assign a group to an admin by using the command"," ",(0,a.jsx)(u,{size:"sm",children:"css_addadmin [steam64] [name] [groupId] [immunity - 0]"})]}),(0,a.jsx)(et,{})]}),(0,a.jsx)(ed,{})]})},"groups")]})})}},79476:function(e,s,i){"use strict";var a=i(12412),n=i(38751),r=i(23733),t=i(99940),l=i(92876),d=i(74226),o=i(82167);s.Z=e=>{let{open:s,title:i,text:c,onAction:m,onCancel:u}=e;return(0,a.jsx)(r.R,{isOpen:s,onOpenChange:u,children:(0,a.jsx)(t.A,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.k,{className:"flex flex-col gap-1",children:i}),(0,a.jsx)(d.I,{children:c}),(0,a.jsxs)(o.R,{children:[(0,a.jsx)(n.A,{color:"default",variant:"flat",onPress:e,children:"Cancel"}),(0,a.jsx)(n.A,{color:"primary",type:"submit",onClick:m,children:i})]})]})})})}},20172:function(e,s,i){"use strict";i.d(s,{Z:function(){return a}});var a=(0,i(2327).Z)("edit","IconEdit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]])},41920:function(e,s,i){"use strict";var a=i(30052);s.Z=e=>a.Z.get(e).then(e=>e.data)},74837:function(e,s,i){"use strict";i.d(s,{hY:function(){return l},jc:function(){return d}});var a=i(65414),n=i(1281),r=i(41920),t=i(30052);let l=async()=>{await (0,t.Z)("/api/auth/logout"),await (0,n.JG)("/api/auth"),a.Am.success("Logged out successfully")},d=()=>{let e=window.innerWidth/2-300,s=window.innerHeight/2-400,i=window.open("/api/auth/login/","","toolbar=no, location=no, directories=no, status=no, menubar=no, \n		  scrollbars=no, resizable=yes, copyhistory=no, width=".concat(600,", \n		  height=").concat(800,", top=").concat(s,", left=").concat(e)),r=setInterval(async()=>{i&&i.closed&&(await (0,n.JG)("/api/auth"),a.Am.success("Logged in successfully!"),clearInterval(r))},1e3)};s.ZP=()=>{let{data:e,isLoading:s,error:i}=(0,n.ZP)("/api/auth",r.Z);return e&&e.admin&&e.admin.group&&(e.admin.flags=e.admin.group.flags,e.admin.immunity=e.admin.group.immunity),{user:i||!e?null:e.user,admin:i||!e?null:e.admin,isLoading:s}}}},function(e){e.O(0,[687,9020,9208,1281,5414,6187,2163,5194,3806,4560,5440,9802,5204,9773,3182,5522,9097,6116,2761,5586,5284,3866,7416,1744],function(){return e(e.s=19074)}),_N_E=e.O()}]);