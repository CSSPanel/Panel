(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[432],{1542:(e,s,i)=>{"use strict";i.d(s,{Ay:()=>o,mg:()=>d,vx:()=>t});var a=i(4394),r=i(4452),l=i(87031),n=i(59241);let t=async()=>{await (0,n.A)("/api/auth/logout"),await (0,r.Tk)("/api/auth"),a.oR.success("Logged out successfully")},d=()=>{let e=window.innerWidth/2-300,s=window.innerHeight/2-400,i=window.open("/api/auth/login/","","toolbar=no, location=no, directories=no, status=no, menubar=no, \n		  scrollbars=no, resizable=yes, copyhistory=no, width=".concat(600,", \n		  height=").concat(800,", top=").concat(s,", left=").concat(e)),l=setInterval(async()=>{i&&i.closed&&(await (0,r.Tk)("/api/auth"),a.oR.success("Logged in successfully!"),clearInterval(l))},1e3)},o=()=>{let{data:e,isLoading:s,error:i}=(0,r.Ay)("/api/auth",l.A);return e&&e.admin&&e.admin.group&&(e.admin.flags=e.admin.group.flags,e.admin.immunity=e.admin.group.immunity),{user:i||!e?null:e.user,admin:i||!e?null:e.admin,masterAdmin:!i&&!!e&&e.masterAdmin,isLoading:s}}},9351:(e,s,i)=>{"use strict";i.d(s,{default:()=>d});var a=i(75819),r=i(19219),l=i(26935),n=i(56027),t=i(1542);let d=e=>{let{children:s,flags:i}=e,{admin:d,isLoading:o}=(0,t.Ay)(),c=(0,l.useRouter)();return(0,n.useEffect)(()=>{if(!o&&(!d||i.length>0&&!i.some(e=>{var s;return null===(s=d.flags)||void 0===s?void 0:s.includes(e)})))return c.push("/")},[d,o,c,i]),o?(0,a.jsx)(r.o,{}):d?(0,a.jsx)(a.Fragment,{children:s}):(0,a.jsx)(a.Fragment,{children:"No Access"})}},13314:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>eg});var a=i(75819),r=i(26331),l=i(87480),n=i(77751),t=i(80007),d=i(26935),o=i(74735),c=i(96904),m=i(93148),u=i(93562),g=i(19500),p=i(9351),h=i(33004);let f=(0,h.vt)(e=>({open:!1,setOpen:s=>e({open:s,edit:null}),edit:null,setEdit:s=>e({edit:s,open:!0}),delete:null,setDelete:s=>e({delete:s}),servers:[],setServers:s=>e({servers:s})}));var v=i(38597),x=i(57187),j=i(62989),y=i(43838),b=i(51936),w=i(35182),A=i(68027),S=i(71095),_=i(56027),F=i(57507),N=i(59384),C=i(19219),z=i(4394),T=i(86114),E=i(4452),R=i(60454),W=i(1542),D=i(87031),k=i(14738),M=i.n(k),I=i(59241);let O=()=>{var e;let s=f(e=>e.setServers),{admin:i,masterAdmin:r}=(0,W.Ay)(),{data:l,isLoading:n}=(0,E.Ay)("/api/admin/admins",D.A);(0,_.useEffect)(()=>{var e;l&&s(null!==(e=null==l?void 0:l.servers)&&void 0!==e?e:[])},[l,s]);let t=f(e=>e.setEdit),d=f(e=>e.delete),o=f(e=>e.setDelete),c=async()=>{if(d){try{await (0,I.A)("/api/admin/admins/".concat(d.id),{method:"DELETE"}),z.oR.success("Succesfully deleted admin!"),await (0,E.Tk)("/api/admin/admins"),await (0,E.Tk)("/api/admin/groups")}catch(s){var e;z.oR.error(null!==(e=s.response.data)&&void 0!==e?e:"Failed to delete admin!")}o(null)}},u=!n&&(null==l?void 0:l.servers)&&(null==l?void 0:l.admins)?"idle":"loading",g=(e,s)=>{switch(s){case"id":return(0,a.jsx)(T.R,{variant:"flat",size:"sm",children:e.id});case"group":{let s="string"==typeof e.flags&&e.flags.startsWith("#")?null==l?void 0:l.groups.find(s=>s.id===e.flags):null;return s?s.name:(0,a.jsx)(a.Fragment,{children:"-"})}case"server":var n,d;if(null===(n=e.servers_groups)||void 0===n?void 0:n.length)return(0,a.jsxs)("div",{className:"flex flex-col gap-1 items-center",children:[(0,a.jsx)("span",{className:"text-xs",children:"Groups:"}),(0,a.jsx)("div",{className:"flex gap-2",children:e.servers_groups.map(e=>{var s;let{name:i,servers:r}=null!==(s=null==l?void 0:l.serversGroups.find(s=>s.id.toString()===e))&&void 0!==s?s:{servers:[],name:"Unknown"},n=r.map(e=>{var s;return null==l?void 0:null===(s=l.servers.find(s=>s.id.toString()===e))||void 0===s?void 0:s.hostname}).filter(Boolean);return(0,a.jsx)(N.I,{content:n.join("\n"),className:"whitespace-pre-wrap",closeDelay:50,color:"success","aria-label":i,children:(0,a.jsxs)(T.R,{variant:"flat",size:"sm",color:"success",children:[r.length," Servers (",i,")"]})},e)})})]});{if(!e.server_id)return(0,a.jsx)(a.Fragment,{children:"ALL"});if(e.server_id.length>1){let s=e.server_id.map(e=>{var s;return null==l?void 0:null===(s=l.servers.find(s=>s.id.toString()===e))||void 0===s?void 0:s.hostname});return(0,a.jsx)(N.I,{content:s.join("\n"),className:"whitespace-pre-wrap",closeDelay:50,color:"primary","aria-label":s.join(", "),children:(0,a.jsxs)(T.R,{variant:"flat",size:"sm",color:"primary",children:[s.length," Servers"]})})}let s=null==l?void 0:l.servers.find(s=>s.id==(e.server_id||0));return(0,a.jsx)(T.R,{variant:"flat",size:"sm",children:null!==(d=null==s?void 0:s.hostname)&&void 0!==d?d:"Unknown"})}case"player_name":return(0,a.jsx)("div",{children:e.player_name});case"player_steamid":return(0,a.jsx)(M(),{href:"https://steamcommunity.com/profiles/".concat(e[s]),target:"_blank",children:e.player_steamid});case"flags":let c="string"==typeof e.flags&&e.flags.startsWith("#")?null==l?void 0:l.groups.find(s=>s.id===e.flags):null,u=c?c.flags:e.flags,g=u&&"object"==typeof u?u.join(", "):u,p=u&&"object"==typeof u?u.join("\n"):g,h="string"==typeof g?g.split(", "):g,f=h.filter(e=>e.startsWith("@web")),v=h.filter(e=>!e.startsWith("@web"));return c?(0,a.jsx)(N.I,{content:p,closeDelay:50,color:"secondary",className:"whitespace-pre-wrap","aria-label":c.name,children:(0,a.jsxs)(T.R,{variant:"flat",size:"sm",color:"secondary",children:[h.length," Flags from ",null==c?void 0:c.name]})}):e.flags.length>2?(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[f.length?(0,a.jsx)(N.I,{content:f.join("\n"),closeDelay:50,color:"primary",className:"whitespace-pre-wrap","aria-label":f.join(", "),children:(0,a.jsxs)(T.R,{variant:"flat",size:"sm",color:"primary",children:[f.length," Web Flags"]})}):(0,a.jsx)(a.Fragment,{}),v.length?(0,a.jsx)(N.I,{content:v.join("\n"),closeDelay:50,color:"secondary",className:"whitespace-pre-wrap","aria-label":v.join(", "),children:(0,a.jsxs)(T.R,{variant:"flat",size:"sm",color:"secondary",children:[v.length," Admin Flags"]})}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsx)(T.R,{variant:"flat",size:"sm",children:h.join(", ")});case"immunity":return(0,a.jsx)(T.R,{variant:"flat",size:"sm",children:e.immunity});case"ends":return e.ends?(0,F.m)(new Date(e.ends)):"Never";case"actions":let x=!!(Number(i.immunity)<Number(e.immunity)&&(null==i?void 0:i.immunity)!=="100"&&!r);return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(m.T,{size:"sm",variant:"flat",color:"primary",onClick:()=>t(e),isDisabled:x,children:[(0,a.jsx)(A.A,{size:16}),"Edit Admin"]}),(0,a.jsxs)(m.T,{size:"sm",variant:"flat",color:"danger",onClick:()=>o(e),isDisabled:x,children:[(0,a.jsx)(S.A,{size:16}),"Delete Admin"]})]});default:return(0,a.jsx)(a.Fragment,{children:"Error!"})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(v.j,{isStriped:!0,children:[(0,a.jsxs)(x.X,{children:[(0,a.jsx)(j.e,{children:"ID"},"id"),(0,a.jsx)(j.e,{children:"Name"},"player_name"),(0,a.jsx)(j.e,{children:"SteamId"},"player_steamid"),(0,a.jsx)(j.e,{children:"Group"},"group"),(0,a.jsx)(j.e,{children:"Servers"},"server"),(0,a.jsx)(j.e,{children:"Immunity"},"immunity"),(0,a.jsx)(j.e,{children:"Flags / Group"},"flags"),(0,a.jsx)(j.e,{children:"Ends"},"ends"),(0,a.jsx)(j.e,{children:"Actions"},"actions")]}),(0,a.jsx)(y.E,{loadingContent:(0,a.jsx)(C.o,{}),loadingState:u,isLoading:"loading"===u,items:null!==(e=null==l?void 0:l.admins)&&void 0!==e?e:[],children:e=>(0,a.jsx)(b.s,{children:s=>(0,a.jsx)(w.w,{children:g(e,s)})})})]}),(0,a.jsx)(R.A,{open:!!d,onAction:c,onCancel:()=>o(null),title:"Delete admin",text:(0,a.jsxs)("p",{children:["Are you sure you want to delete: ",(0,a.jsx)("b",{children:null==d?void 0:d.player_name})," admin?"]})})]})};var V=i(46777),P=i(88901),Y=i(38245),G=i(88780),L=i(38512),U=i(69543),K=i(90419),q=i(54072),X=i(40947),Z=i(86778),$=i(10364),B=i(72626),H=i(95386),J=i(22476),Q=i(30908),ee=i(9316),es=i(27580),ei=i(39223);let ea=()=>{var e,s,i,r;let l=f(e=>e.open),n=f(e=>e.edit),t=f(e=>e.setOpen),d=f(e=>e.servers),{admin:o,masterAdmin:c}=(0,W.Ay)(),[u,g]=(0,_.useState)(!n||!n.server_id&&!n.servers_groups),[p,h]=(0,_.useState)(!!n&&!!n.ends),[v,x]=(0,_.useState)(!1),{data:j}=(0,E.Ay)("/api/admin/admins",D.A),{data:y}=(0,E.Ay)("/api/admin/flags",D.A),{data:b}=(0,E.Ay)("/api/admin/servers-groups",D.A),w=async()=>{if(!v){if(A.values.ends&&A.values.ends<new Date){z.oR.error("End date cannot be in the past!");return}x(!0);try{await (0,I.A)(n?"/api/admin/admins/".concat(n.id):"/api/admin/admins",{method:n?"PUT":"POST",data:{...A.values,server_id:u?null:A.values.server_id,servers_groups:u?null:A.values.servers_groups,ends:p?A.values.ends?A.values.ends:new Date:null}}),await (0,E.Tk)("/api/admin/admins"),z.oR.success(n?"Succesfully edited admin!":"Succesfully created admin!"),t(!1)}catch(e){console.error(e),z.oR.error("Failed to ".concat(n?"edit":"create"," admin!"))}x(!1)}},A=(0,B.m)({initialValues:{player_name:n?n.player_name:"",player_steamid:n?n.player_steamid:"",server_id:n?n.server_id:null,servers_groups:n&&(null===(e=n.servers_groups)||void 0===e?void 0:e.length)?n.servers_groups:[],flags:n?n.flags:[],immunity:n?n.immunity:"0",ends:n&&n.ends?new Date(n.ends):null},validate:(0,H.u)(ei.Ay)});(0,_.useEffect)(()=>{var e;A.setValues({player_name:n?n.player_name:"",player_steamid:n?n.player_steamid:"",server_id:n?n.server_id:null,servers_groups:n&&(null===(e=n.servers_groups)||void 0===e?void 0:e.length)?n.servers_groups:[],flags:n?n.flags:[],immunity:n?n.immunity:"0",ends:n&&n.ends?new Date(n.ends):null}),g(!n||!n.server_id&&!n.servers_groups),h(!!n&&!!n.ends)},[n]);let S="string"==typeof A.values.flags&&A.values.flags.startsWith("#")&&null!==(i=null==j?void 0:j.groups.find(e=>e.id===A.values.flags))&&void 0!==i?i:void 0,F="string"!=typeof A.values.flags?A.values.flags.join(", "):void 0,N=A.values.server_id?A.values.server_id.length>1?A.values.server_id.length:null!==(r=null===(s=d.find(e=>e.id.toString()===A.values.server_id[0]))||void 0===s?void 0:s.hostname)&&void 0!==r?r:"None":"All";return(0,a.jsx)(V.Y,{isOpen:l,onOpenChange:v?void 0:t,children:(0,a.jsx)(P.g,{children:e=>{var s,i,r,l,t,f,x,_;return(0,a.jsxs)("form",{onSubmit:A.onSubmit(w),children:[(0,a.jsx)(Y.c,{className:"flex flex-col gap-1",children:n?"Edit admin":"Create new admin"}),(0,a.jsxs)(G.h,{children:[(0,a.jsx)(es.r,{...A.getInputProps("player_name"),errorMessage:A.errors.player_name,isInvalid:!!A.errors.player_name,label:"Admin Name",placeholder:"John Doe",variant:"bordered",disabled:v,autoFocus:!0}),(0,a.jsx)(es.r,{...A.getInputProps("player_steamid"),errorMessage:A.errors.player_steamid,isInvalid:!!A.errors.player_steamid,label:"SteamId (64)",placeholder:"76561198000000000",type:"text",variant:"bordered",disabled:v}),(0,a.jsx)(Q.A,{isSelected:u,onValueChange:g,children:"All Servers"}),!u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-xs text-center",children:"You can choose a set of servers or choose a set of servers groups"}),!((A.values.servers_groups||[]).length>0)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(U.A,{children:[(0,a.jsx)(K.b,{children:(0,a.jsxs)(m.T,{variant:"bordered",children:["Servers: ",N]})}),(0,a.jsx)(q.y,{"aria-label":"Servers",items:d,closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...null!==(l=A.values.server_id)&&void 0!==l?l:[]]),onSelectionChange:e=>A.setFieldValue("server_id",Array.from(e)),disallowEmptySelection:!0,children:e=>(0,a.jsx)(X.Y,{id:e.id.toString(),color:"default",children:e.hostname},e.id)})]}),A.errors.server_id&&(0,a.jsx)("span",{className:"text-xs text-red-500",children:A.errors.server_id})]}),(0,a.jsxs)(U.A,{children:[(0,a.jsx)(K.b,{children:(0,a.jsxs)(m.T,{variant:"bordered",children:["Servers Group:"," ",(null===(s=A.values.servers_groups)||void 0===s?void 0:s.map(e=>{var s;return null==b?void 0:null===(s=b.find(s=>s.id.toString()===e))||void 0===s?void 0:s.name}).join(", "))||"None"]})}),(0,a.jsx)(q.y,{"aria-label":"Servers Group",items:b,closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...null!==(t=A.values.servers_groups)&&void 0!==t?t:[]]),onSelectionChange:e=>A.setFieldValue("servers_groups",Array.from(e)),children:e=>(0,a.jsxs)(X.Y,{id:e.id.toString(),color:"default",children:[e.name," (Servers: ",e.servers.length,")"]},e.id)})]}),A.errors.serverGroups&&(0,a.jsx)("span",{className:"text-xs text-red-500",children:A.errors.serverGroups}),(0,a.jsx)(ee.y,{className:"opacity-50"})]}),(0,a.jsxs)(U.A,{children:[(0,a.jsx)(K.b,{children:(0,a.jsxs)(m.T,{variant:"bordered",children:["Group: ",(null==S?void 0:S.name)||"unset"]})}),(0,a.jsx)(q.y,{"aria-label":"Flags",items:null!==(f=null==j?void 0:j.groups)&&void 0!==f?f:[],children:(null==j?void 0:j.groups.map(e=>(0,a.jsxs)(X.Y,{id:e.id,color:"default",onClick:()=>A.setValues({flags:e.id}),children:[e.name," ",A.values.flags===e.id&&"(Selected)"]},e.id)))||(0,a.jsx)(a.Fragment,{})})]}),A.errors.flags&&(0,a.jsx)("span",{className:"text-xs text-red-500",children:A.errors.flags}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)(U.A,{placement:"right",children:[(0,a.jsx)(K.b,{children:(0,a.jsxs)(m.T,{variant:"bordered",children:["Web Flags:"," ",S?(0,a.jsxs)(a.Fragment,{children:[S.flags.filter(e=>e.startsWith("@web/")).length||0," ","(Group)"]}):(null==F?void 0:F.split(", ").filter(e=>e.startsWith("@web")).length)||0]})}),(0,a.jsx)(q.y,{"aria-label":"Web Flags",items:ei.Wg,closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...null!==(x=A.values.flags)&&void 0!==x?x:[]]),onSelectionChange:e=>A.setFieldValue("flags",Array.from(e).filter(e=>ei.d7.includes(e)||(null==y?void 0:y.find(s=>s.flag===e)))),disallowEmptySelection:!0,children:[...ei.Wg.filter(e=>e.id.startsWith("@web/")),...null===(i=y||[])||void 0===i?void 0:i.filter(e=>e.flag.startsWith("@web/"))].concat().map(e=>e.flag?(0,a.jsxs)(X.Y,{id:e.flag,color:"default",children:[e.flag," -"," ",e.identifier," ",(0,a.jsx)(T.R,{color:"primary",variant:"flat",size:"sm",className:"mx-2 text-xs h-5",children:"Custom"})]},e.flag):(0,a.jsxs)(X.Y,{id:e.id,color:"default",children:[e.id," - ",e.description]},e.id))})]}),(0,a.jsxs)(U.A,{placement:"right",children:[(0,a.jsx)(K.b,{children:(0,a.jsxs)(m.T,{variant:"bordered",children:["Admin Flags:"," ",S?(0,a.jsxs)(a.Fragment,{children:[S.flags.filter(e=>!e.startsWith("@web/")).length||0," ","(Group)"]}):(null==F?void 0:F.split(", ").filter(e=>!e.startsWith("@web")).length)||0]})}),(0,a.jsx)(q.y,{"aria-label":"Admin Flags",items:ei.Wg,closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...null!==(_=A.values.flags)&&void 0!==_?_:[]]),onSelectionChange:e=>A.setFieldValue("flags",Array.from(e).filter(e=>ei.d7.includes(e)||(null==y?void 0:y.find(s=>s.flag===e)))),disallowEmptySelection:!0,children:[...ei.Wg.filter(e=>e.id.startsWith("@css/")),...null===(r=y||[])||void 0===r?void 0:r.filter(e=>!e.flag.startsWith("@web/"))].concat().map(e=>e.flag?(0,a.jsxs)(X.Y,{id:e.flag,color:"default",children:[e.flag," -"," ",e.identifier," ",(0,a.jsx)(T.R,{color:"primary",variant:"flat",size:"sm",className:"mx-2 text-xs h-5",children:"Custom"})]},e.flag):(0,a.jsxs)(X.Y,{id:e.id,color:"default",children:[e.id," - ",e.description]},e.id))})]})]}),(0,a.jsx)("span",{className:"text-xs",children:"You can choose either pre defined group, or flags."}),(0,a.jsx)(es.r,{value:A.values.immunity,onChange:e=>(null==o?void 0:o.immunity)==="100"?A.setFieldValue("immunity",e.target.value):Number(e.target.value)<Number(null==o?void 0:o.immunity)&&Number(e.target.value)>=0&&A.setFieldValue("immunity",e.target.value),errorMessage:A.errors.immunity,isInvalid:!!A.errors.immunity,label:"Immunity",placeholder:"Example, 99".concat(c?"":", max of ".concat(Number(null==o?void 0:o.immunity)-1)),description:c?"No limit":"Max of ".concat(Number(null==o?void 0:o.immunity)-1," (Your immunity - 1)"),type:"number",variant:"bordered",disabled:v}),(0,a.jsx)(Q.A,{isSelected:p,onValueChange:h,children:"Time Restriction"}),(0,a.jsx)(J.g,{isDisabled:!p,variant:"bordered",label:"End Date",value:A.values.ends?(0,Z._U)(A.values.ends.toISOString().split("T")[0]):null,onChange:e=>A.setFieldValue("ends",e.toDate((0,$.Xj)())),errorMessage:A.errors.ends,isInvalid:!!A.errors.ends,showMonthAndYearPickers:!0,hideTimeZone:!0})]}),(0,a.jsxs)(L.q,{children:[(0,a.jsx)(m.T,{color:"danger",variant:"flat",onPress:e,disabled:v,children:"Cancel"}),(0,a.jsx)(m.T,{color:"primary",type:"submit",isLoading:v,children:n?"Edit admin":"Create admin"})]})]})}})})},er=(0,h.vt)(e=>({open:!1,setOpen:s=>e({open:s,edit:null}),edit:null,setEdit:s=>e({edit:s,open:!0}),delete:null,setDelete:s=>e({delete:s})})),el=()=>{let{admin:e}=(0,W.Ay)(),{data:s,isLoading:i}=(0,E.Ay)("/api/admin/groups",D.A),{data:r}=(0,E.Ay)("/api/admin/flags",D.A),l=er(e=>e.setEdit),n=er(e=>e.delete),t=er(e=>e.setDelete),d=async()=>{if(n){try{await (0,I.A)("/api/admin/groups/".concat(n.id.replace("#","")),{method:"DELETE"}),z.oR.success("Succesfully deleted group!"),await (0,E.Tk)("/api/admin/groups"),await (0,E.Tk)("/api/admin/admins")}catch(s){var e;z.oR.error(null!==(e=s.response.data)&&void 0!==e?e:"Failed to delete group!")}t(null)}},o=i||!s?"loading":"idle",c=(s,i)=>{switch(i){case"id":return(0,a.jsx)(T.R,{variant:"flat",size:"sm",children:s.id});case"name":return(0,a.jsx)("div",{children:s.name});case"flags":let r=s.flags,n=r.filter(e=>e.startsWith("@web")),d=r.filter(e=>!e.startsWith("@web"));return"string"!=typeof s.flags?s.flags?s.flags.length>2?(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[n.length?(0,a.jsx)(N.I,{content:n.join("\n"),closeDelay:50,color:"primary",className:"whitespace-pre-wrap","aria-label":"Web Flags",children:(0,a.jsxs)(T.R,{variant:"flat",size:"sm",color:"primary",children:[n.length," Web Flags"]})}):(0,a.jsx)(a.Fragment,{}),d.length?(0,a.jsx)(N.I,{content:d.join("\n"),closeDelay:50,color:"secondary",className:"whitespace-pre-wrap","aria-label":"Admin Flags",children:(0,a.jsxs)(T.R,{variant:"flat",size:"sm",color:"secondary",children:[d.length," Admin Flags"]})}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsx)(T.R,{variant:"flat",size:"sm",children:s.flags.join(", ")}):"":s.flags;case"immunity":return(0,a.jsx)(T.R,{variant:"flat",size:"sm",children:s.immunity});case"created":return(0,a.jsxs)(a.Fragment,{children:[(0,F.m)(new Date(s.created||""))," ago"]});case"actions":let o=Number(e.immunity)<Number(s.immunity)&&(null==e?void 0:e.immunity)!=="100";return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(m.T,{size:"sm",variant:"flat",color:"primary",onClick:()=>l(s),isDisabled:o,children:[(0,a.jsx)(A.A,{size:16}),"Edit Admin Group"]}),(0,a.jsxs)(m.T,{size:"sm",variant:"flat",color:"danger",onClick:()=>t(s),isDisabled:o,children:[(0,a.jsx)(S.A,{size:16}),"Delete Admin Group"]})]});default:return(0,a.jsx)(a.Fragment,{children:"Error!"})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(v.j,{children:[(0,a.jsxs)(x.X,{children:[(0,a.jsx)(j.e,{children:"ID"},"id"),(0,a.jsx)(j.e,{children:"Name"},"name"),(0,a.jsx)(j.e,{children:"Flags"},"flags"),(0,a.jsx)(j.e,{children:"Immunity"},"immunity"),(0,a.jsx)(j.e,{children:"Created"},"created"),(0,a.jsx)(j.e,{children:"Actions"},"actions")]}),(0,a.jsx)(y.E,{loadingContent:(0,a.jsx)(C.o,{}),loadingState:o,isLoading:"loading"===o,items:null!=s?s:[],children:e=>(0,a.jsx)(b.s,{children:s=>(0,a.jsx)(w.w,{children:c(e,s)})})})]}),(0,a.jsx)(R.A,{open:!!n,onAction:d,onCancel:()=>t(null),title:"Delete group",text:(0,a.jsxs)("p",{children:["Are you sure you want to delete: ",(0,a.jsx)("b",{children:null==n?void 0:n.name})," group?"]})})]})};var en=i(71837);let et=en.z.object({id:en.z.string().min(3).refine(e=>e.startsWith("#"),{message:"The id must start with #"}),name:en.z.string().min(3),flags:en.z.array(ei.nS),immunity:en.z.string().min(0).max(100)}),ed=()=>{let e=er(e=>e.open),s=er(e=>e.edit),i=er(e=>e.setOpen),{data:r}=(0,E.Ay)("/api/admin/flags",D.A),{admin:l,masterAdmin:n}=(0,W.Ay)(),[t,d]=(0,_.useState)(!1),o=async()=>{if(!t){d(!0);try{await (0,I.A)(s?"/api/admin/groups/".concat(s.id.replace("#","")):"/api/admin/groups",{method:s?"PUT":"POST",data:c.values}),await (0,E.Tk)("/api/admin/groups"),await (0,E.Tk)("/api/admin/admins"),z.oR.success(s?"Succesfully edited group!":"Succesfully created group!"),i(!1)}catch(e){console.error(e),z.oR.error("Failed to ".concat(s?"edit":"create"," group!"))}d(!1)}},c=(0,B.m)({initialValues:{id:s?s.id:"#",name:s?s.name:"",flags:s?s.flags:["@css/generic"],immunity:s?s.immunity.toString():"0"},validate:(0,H.u)(et)});return(0,_.useEffect)(()=>{c.setValues({id:s?s.id:"#",name:s?s.name:"",flags:s?s.flags:["@css/generic"],immunity:s?s.immunity.toString():"0"})},[s]),(0,_.useEffect)(()=>{c.values.name&&c.setValues({id:"#".concat(c.values.name.toLowerCase().replace(/\s/g,"-"))})},[c.values.name]),(0,a.jsx)(V.Y,{isOpen:e,onOpenChange:t?void 0:i,children:(0,a.jsx)(P.g,{children:e=>{var i,d;return(0,a.jsxs)("form",{onSubmit:c.onSubmit(o),children:[(0,a.jsx)(Y.c,{className:"flex flex-col gap-1",children:s?"Edit group":"Create new group"}),(0,a.jsxs)(G.h,{children:[(0,a.jsx)(es.r,{...c.getInputProps("name"),errorMessage:c.errors.name,isInvalid:!!c.errors.name,label:"Group Name",placeholder:"Example, Admins",variant:"bordered",disabled:t,autoFocus:!0}),(0,a.jsx)(es.r,{...c.getInputProps("id"),errorMessage:c.errors.id,isInvalid:!!c.errors.id,label:"Group ID",placeholder:"Example, #admins",type:"text",variant:"bordered",disabled:t}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)(U.A,{placement:"right",children:[(0,a.jsx)(K.b,{children:(0,a.jsxs)(m.T,{variant:"bordered",children:["Web Flags: ",c.values.flags.filter(e=>e.startsWith("@web")).length]})}),(0,a.jsx)(q.y,{"aria-label":"Web Flags",items:[...ei.Wg.filter(e=>e.id.startsWith("@web/")),...null===(i=r||[])||void 0===i?void 0:i.filter(e=>e.flag.startsWith("@web/"))].concat(),closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...c.values.flags]),onSelectionChange:e=>c.setFieldValue("flags",Array.from(e)),disallowEmptySelection:!0,children:e=>e.flag?(0,a.jsxs)(X.Y,{id:e.flag,color:"default",children:[e.flag," - ",e.identifier," ",(0,a.jsx)(T.R,{color:"primary",variant:"flat",size:"sm",className:"mx-2 text-xs h-5",children:"Custom"})]},e.flag):(0,a.jsxs)(X.Y,{id:e.id,color:"default",children:[e.id," - ",e.description]},e.id)})]}),(0,a.jsxs)(U.A,{placement:"right",children:[(0,a.jsx)(K.b,{children:(0,a.jsxs)(m.T,{variant:"bordered",children:["Admin Flags:"," ",c.values.flags.filter(e=>!e.startsWith("@web/")).length]})}),(0,a.jsx)(q.y,{"aria-label":"Admin Flags",items:[...ei.Wg.filter(e=>!e.id.startsWith("@web/")),...null===(d=r||[])||void 0===d?void 0:d.filter(e=>!e.flag.startsWith("@web/"))].concat(),closeOnSelect:!1,selectionMode:"multiple",selectedKeys:new Set([...c.values.flags]),onSelectionChange:e=>c.setFieldValue("flags",Array.from(e)),disallowEmptySelection:!0,children:e=>e.flag?(0,a.jsxs)(X.Y,{id:e.flag,color:"default",children:[e.flag," - ",e.identifier," ",(0,a.jsx)(T.R,{color:"primary",variant:"flat",size:"sm",className:"mx-2 text-xs h-5",children:"Custom"})]},e.flag):(0,a.jsxs)(X.Y,{id:e.id,color:"default",children:[e.id," - ",e.description]},e.id)})]})]}),(0,a.jsx)(es.r,{value:c.values.immunity,onChange:e=>n?c.setFieldValue("immunity",e.target.value):(null==l?void 0:l.immunity)==="100"?c.setFieldValue("immunity","99"):Number(e.target.value)<Number(null==l?void 0:l.immunity)&&Number(e.target.value)>=0&&c.setFieldValue("immunity",e.target.value),errorMessage:c.errors.immunity,isInvalid:!!c.errors.immunity,label:"Immunity",placeholder:"Example, 99".concat(n?"":", max of ".concat(Number(null==l?void 0:l.immunity)-1)),description:n?"Max of ".concat(Number(null==l?void 0:l.immunity)-1," (Your immunity - 1)"):"No limit",type:"number",variant:"bordered",disabled:t})]}),(0,a.jsxs)(L.q,{children:[(0,a.jsx)(m.T,{color:"danger",variant:"flat",onPress:e,disabled:t,children:"Cancel"}),(0,a.jsx)(m.T,{color:"primary",type:"submit",isLoading:t,children:s?"Edit admin group":"Create admin group"})]})]})}})})},eo=(0,h.vt)(e=>({open:!1,setOpen:s=>e({open:s,edit:null}),edit:null,setEdit:s=>e({edit:s,open:!0}),delete:null,setDelete:s=>e({delete:s})})),ec=()=>{let{data:e,isLoading:s}=(0,E.Ay)("/api/admin/flags",D.A),i=eo(e=>e.setEdit),r=eo(e=>e.delete),l=eo(e=>e.setDelete),n=async()=>{if(r){try{await (0,I.A)("/api/admin/flags/".concat(r.flag.replace("@","").replace("/","$")),{method:"DELETE"}),z.oR.success("Succesfully deleted flag!"),await (0,E.Tk)("/api/admin/flags"),await (0,E.Tk)("/api/admin/groups"),await (0,E.Tk)("/api/admin/admins")}catch(s){var e;z.oR.error(null!==(e=s.response.data)&&void 0!==e?e:"Failed to delete flag!")}l(null)}},t=s||!e?"loading":"idle",d=(e,s)=>{switch(s){case"flag":return(0,a.jsx)(T.R,{color:"primary",variant:"flat",size:"sm",children:e.flag});case"identifier":return(0,a.jsx)("div",{children:e.identifier});case"created":return(0,a.jsxs)(a.Fragment,{children:[(0,F.m)(new Date(e.created||""))," ago"]});case"actions":return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(m.T,{size:"sm",variant:"flat",color:"primary",onClick:()=>i(e),children:[(0,a.jsx)(A.A,{size:16}),"Edit Flag"]}),(0,a.jsxs)(m.T,{size:"sm",variant:"flat",color:"danger",onClick:()=>l(e),children:[(0,a.jsx)(S.A,{size:16}),"Delete Flag"]})]});default:return(0,a.jsx)(a.Fragment,{children:"Error!"})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(v.j,{children:[(0,a.jsxs)(x.X,{children:[(0,a.jsx)(j.e,{children:"Flag"},"flag"),(0,a.jsx)(j.e,{children:"Identifier"},"identifier"),(0,a.jsx)(j.e,{children:"Created"},"created"),(0,a.jsx)(j.e,{children:"Actions"},"actions")]}),(0,a.jsx)(y.E,{loadingContent:(0,a.jsx)(C.o,{}),loadingState:t,isLoading:"loading"===t,items:null!=e?e:[],children:e=>(0,a.jsx)(b.s,{children:s=>(0,a.jsx)(w.w,{children:d(e,s)})},e.flag)})]}),(0,a.jsx)(R.A,{open:!!r,onAction:n,onCancel:()=>l(null),title:"Delete flag",text:(0,a.jsxs)("p",{children:["Are you sure you want to delete: ",(0,a.jsx)("b",{children:null==r?void 0:r.flag})," flag?"]})})]})},em=en.z.object({flag:en.z.string().startsWith("@","The flag must start with @").includes("/",{message:"The flag must contain a /"}).min(3),identifier:en.z.string()}),eu=()=>{let e=eo(e=>e.open),s=eo(e=>e.edit),i=eo(e=>e.setOpen),[r,l]=(0,_.useState)(!1),n=async()=>{if(!r){l(!0);try{await (0,I.A)(s?"/api/admin/flags/".concat(s.flag.replace("@","").replace("/","$")):"/api/admin/flags",{method:s?"PUT":"POST",data:t.values}),await (0,E.Tk)("/api/admin/flags"),await (0,E.Tk)("/api/admin/groups"),await (0,E.Tk)("/api/admin/admins"),z.oR.success(s?"Succesfully edited flag!":"Succesfully created flag!"),t.reset(),i(!1)}catch(e){console.error(e),z.oR.error("Failed to ".concat(s?"edit":"create"," flag!"))}l(!1)}},t=(0,B.m)({initialValues:{flag:s?s.flag:"@",identifier:s?s.identifier:""},validate:(0,H.u)(em)});return(0,_.useEffect)(()=>{t.setValues({flag:s?s.flag:"@",identifier:s?s.identifier:""})},[s]),(0,a.jsx)(V.Y,{isOpen:e,onOpenChange:r?void 0:i,children:(0,a.jsx)(P.g,{children:e=>(0,a.jsxs)("form",{onSubmit:t.onSubmit(n),children:[(0,a.jsx)(Y.c,{className:"flex flex-col gap-1",children:s?"Edit flag":"Create new flag"}),(0,a.jsxs)(G.h,{children:[(0,a.jsx)(es.r,{...t.getInputProps("flag"),errorMessage:t.errors.flag,isInvalid:!!t.errors.flag,label:"Flag",placeholder:"Example, @custom/my-custom-flag",variant:"bordered",disabled:r,autoFocus:!0}),(0,a.jsx)(es.r,{...t.getInputProps("identifier"),errorMessage:t.errors.identifier,isInvalid:!!t.errors.identifier,label:"Flag identifier",placeholder:"Example: flag for VIP users",type:"text",variant:"bordered",disabled:r})]}),(0,a.jsxs)(L.q,{children:[(0,a.jsx)(m.T,{color:"danger",variant:"flat",onPress:e,disabled:r,children:"Cancel"}),(0,a.jsx)(m.T,{color:"primary",type:"submit",isLoading:r,children:s?"Edit custom flag":"Create custom flag"})]})]})})})},eg=()=>{let e=f(e=>e.setOpen),s=er(e=>e.setOpen),i=eo(e=>e.setOpen),h=(0,d.usePathname)(),v=g.b.find(e=>e.path===h);return(0,a.jsx)(p.default,{flags:(null==v?void 0:v.permissions)||[],children:(0,a.jsxs)(o.r,{"aria-label":"Options",children:[(0,a.jsx)(c.i,{title:"Manage Admins",children:(0,a.jsxs)(r.Z,{children:[(0,a.jsxs)(l.d,{className:"text-2xl font-medium flex flex-row justify-between",children:["Manage Admins",(0,a.jsxs)(m.T,{size:"sm",variant:"flat",color:"primary",onClick:()=>e(!0),children:[(0,a.jsx)(t.A,{}),"Create new Admin"]})]}),(0,a.jsx)(n.U,{children:(0,a.jsx)(O,{})}),(0,a.jsx)(ea,{})]})},"admins"),(0,a.jsx)(c.i,{title:"Manage Groups",children:(0,a.jsxs)(r.Z,{children:[(0,a.jsxs)(l.d,{className:"text-2xl font-medium flex flex-row justify-between",children:["Manage Admin Groups",(0,a.jsxs)(m.T,{size:"sm",variant:"flat",color:"primary",onClick:()=>s(!0),children:[(0,a.jsx)(t.A,{}),"Create new group"]})]}),(0,a.jsxs)(n.U,{children:[(0,a.jsxs)("p",{className:"text-sm mb-6",children:["Admin groups are used to make pre-defined permissions for admins, you can assign an admin to a group and whenever you change the group permissions, the admin will automatically get the new permissions.",(0,a.jsx)("br",{}),"Note that you can also assign a group to an admin by using the command"," ",(0,a.jsx)(u.m,{size:"sm",children:"css_addadmin [steam64] [name] [groupId] [immunity - 0]"})]}),(0,a.jsx)(el,{})]}),(0,a.jsx)(ed,{})]})},"groups"),(0,a.jsx)(c.i,{title:"Custom Flags",children:(0,a.jsxs)(r.Z,{children:[(0,a.jsxs)(l.d,{className:"text-2xl font-medium flex flex-row justify-between",children:["Manage Flags",(0,a.jsxs)(m.T,{size:"sm",variant:"flat",color:"primary",onClick:()=>i(!0),children:[(0,a.jsx)(t.A,{}),"Create new flag"]})]}),(0,a.jsxs)(n.U,{children:[(0,a.jsxs)("p",{className:"text-sm mb-6",children:["Admin flags are used to give permissions to admins, you can assign an admin to a flag and whenever you change the flag permissions, the admin will automatically get the new permissions.",(0,a.jsx)("br",{}),"The flags will be shown as ",(0,a.jsx)(u.m,{children:"@custom/your-flag"}),(0,a.jsx)("br",{}),"You can also create a flag with a custom prefix, for example,"," ",(0,a.jsx)(u.m,{children:"@web/your-flag"})," and it will also be shown in the dropdown menu."]}),(0,a.jsx)(ec,{})]}),(0,a.jsx)(eu,{})]})},"flags")]})})}},19500:(e,s,i)=>{"use strict";i.d(s,{b:()=>c,default:()=>o});var a=i(75819),r=i(95889),l=i(26935),n=i(74735),t=i(96904),d=i(1542);let o=()=>{let e=(0,l.usePathname)(),s=(0,l.useRouter)(),{admin:i}=(0,d.Ay)(),o=(null==i?void 0:i.flags)||[],m=(0,r.q)(e=>e.modules),u=c.filter(e=>e.permissions.some(e=>o.includes(e))).filter(e=>{if(e.module){let s=m.find(s=>s.identifier===e.module);if(!s||!s.enabled)return!1}return!0});return(0,a.jsx)(n.r,{"aria-label":"Admin-tabs",selectedKey:e,onSelectionChange:e=>s.push(e),items:u,children:e=>(0,a.jsx)(t.i,{title:e.title},e.path)})},c=[{path:"/admin",title:"Statistics",permissions:["@web/root","@web/logs","@css/root","@web/stats"]},{path:"/admin/modules",title:"Modules",permissions:["@web/root","@css/root"]},{path:"/admin/admins",title:"Manage Admins",permissions:["@web/root","@css/root","@web/admins"]},{path:"/admin/servers",title:"Manage Servers",permissions:["@web/root","@css/root","@web/servers","@web/rcon"]},{path:"/admin/bans",title:"Manage Bans",permissions:["@web/root","@css/root","@web/bans"]},{path:"/admin/mutes",title:"Manage Mutes",permissions:["@web/root","@css/root","@web/mutes"]},{path:"/admin/logs",title:"Logs",permissions:["@web/root","@css/root","@web/logs"]},{path:"/admin/advertisements",title:"Advertisements (module)",permissions:["@web/root","@css/root","@web/logs"],module:"advertisements"},{path:"/admin/settings",title:"Panel Settings",permissions:["@web/root","@css/root"]}]},39223:(e,s,i)=>{"use strict";i.d(s,{Ay:()=>t,Wg:()=>r,d7:()=>l,nS:()=>n});var a=i(71837);let r=[{id:"@css/reservation",description:"Reserved slot access."},{id:"@css/generic",description:"Generic admin."},{id:"@css/kick",description:"Kick other players."},{id:"@css/ban",description:"Ban other players."},{id:"@css/permban",description:"Perma ban other players."},{id:"@css/unban",description:"Remove bans."},{id:"@css/vip",description:"General vip status."},{id:"@css/slay",description:"Slay/harm other players."},{id:"@css/changemap",description:"Change the map or major gameplay features."},{id:"@css/cvar",description:"Change most cvars."},{id:"@css/config",description:"Execute config files."},{id:"@css/chat",description:"Special chat privileges."},{id:"@css/vote",description:"Start or create votes."},{id:"@css/password",description:"Set a password on the server."},{id:"@css/rcon",description:"Use RCON commands."},{id:"@css/cheats",description:"Change sv_cheats or use cheating commands."},{id:"@css/root",description:"Magically enables all flags and ignores immunity values."},{id:"@web/root",description:"Web panel root access."},{id:"@web/admins",description:"Manage web admins."},{id:"@web/admingroups",description:"Manage web admin groups."},{id:"@web/bans",description:"Manage bans."},{id:"@web/mutes",description:"Manage mutes."},{id:"@web/logs",description:"View panel logs."},{id:"@web/stats",description:"View server statistics."},{id:"@web/servers",description:"Manage servers."},{id:"@web/rcon",description:"Manage servers via RCON."}],l=r.map(e=>e.id),n=a.z.string().refine(e=>e.startsWith("@")||e.startsWith("#"),{message:"The flag is not valid"}),t=a.z.object({player_name:a.z.string().min(3).regex(/^[\w\s]+$/),player_steamid:a.z.string().regex(/^7656119\d{10}$/),server_id:a.z.array(a.z.string()).nullable(),servers_groups:a.z.array(a.z.string()).nullable(),flags:a.z.union([a.z.array(n),n]),immunity:a.z.union([a.z.string().min(0).max(100),a.z.number().min(0).max(100)]),ends:a.z.union([a.z.string(),a.z.date()]).nullable()})},60454:(e,s,i)=>{"use strict";i.d(s,{A:()=>c});var a=i(75819),r=i(93148),l=i(46777),n=i(88901),t=i(38245),d=i(88780),o=i(38512);let c=e=>{let{open:s,title:i,text:c,onAction:m,onCancel:u}=e;return(0,a.jsx)(l.Y,{isOpen:s,onOpenChange:u,children:(0,a.jsx)(n.g,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.c,{className:"flex flex-col gap-1",children:i}),(0,a.jsx)(d.h,{children:c}),(0,a.jsxs)(o.q,{children:[(0,a.jsx)(r.T,{color:"default",variant:"flat",onPress:e,children:"Cancel"}),(0,a.jsx)(r.T,{color:"primary",type:"submit",onClick:m,children:i})]})]})})})}},66452:(e,s,i)=>{Promise.resolve().then(i.bind(i,13314))},87031:(e,s,i)=>{"use strict";i.d(s,{A:()=>r});var a=i(59241);let r=e=>a.A.get(e).then(e=>e.data)},95889:(e,s,i)=>{"use strict";i.d(s,{A:()=>o,q:()=>d});var a=i(75819),r=i(56027),l=i(33004),n=i(87031),t=i(4452);let d=(0,l.vt)(e=>({modules:[],setModules:s=>e(()=>({modules:s,isLoading:!1})),isLoading:!0,setLoading:s=>e(()=>({isLoading:s}))})),o=()=>{let{data:e,isLoading:s}=(0,t.Ay)("/api/modules",n.A),i=d(e=>e.setModules),l=d(e=>e.setLoading);return(0,r.useEffect)(()=>{e&&(i(e),l(!1))},[e,s,i,l]),(0,a.jsx)(a.Fragment,{})}}},e=>{var s=s=>e(e.s=s);e.O(0,[3322,4047,2446,4394,3148,7166,494,5168,7580,3695,4738,1737,9680,8552,1837,6183,9099,2626,9407,3165,6026,6196,22,8172,2294,6054,388,7358],()=>s(66452)),_N_E=e.O()}]);