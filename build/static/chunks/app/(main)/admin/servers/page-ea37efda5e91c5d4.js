(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8710],{949:function(e,s,t){Promise.resolve().then(t.bind(t,6419))},7512:function(e,s,t){"use strict";t.r(s);var n=t(1840),r=t(7917),a=t(1318),i=t(4740),l=t(646);s.default=e=>{let{children:s,flags:t}=e,{admin:o,isLoading:c}=(0,l.ZP)(),d=(0,a.useRouter)();return(0,i.useEffect)(()=>{if(!c){if(!o)return d.push("/");if(t.length>0&&!t.some(e=>{var s;return null===(s=o.flags)||void 0===s?void 0:s.includes(e)}))return d.push("/admin")}},[o,c,d,t]),c?(0,n.jsx)(r.c,{}):o?(0,n.jsx)(n.Fragment,{children:s}):(0,n.jsx)(n.Fragment,{children:"No Access"})}},8136:function(e,s,t){"use strict";t.r(s),t.d(s,{ADMIN_TABS:function(){return l}});var n=t(1840),r=t(1318),a=t(994),i=t(986);s.default=()=>{let e=(0,r.usePathname)(),s=(0,r.useRouter)();return(0,n.jsx)(a.n,{"aria-label":"Admin-tabs",selectedKey:e,onSelectionChange:e=>s.push(e),items:l,children:e=>(0,n.jsx)(i.r,{title:e.title},e.path)})};let l=[{path:"/admin",title:"Statistics",permissions:[]},{path:"/admin/admins",title:"Manage Admins",permissions:["@web/root","@css/root","@web/admins"]},{path:"/admin/servers",title:"Manage Servers",permissions:["@web/root","@css/root","@web/servers"]},{path:"/admin/bans",title:"Manage Bans",permissions:["@web/root","@css/root","@web/bans"]},{path:"/admin/mutes",title:"Manage Mutes",permissions:["@web/root","@css/root","@web/mutes"]},{path:"/admin/logs",title:"Logs",permissions:["@web/root","@css/root","@web/logs"]},{path:"/admin/settings",title:"Panel Settings",permissions:["@web/root","@css/root"]}]},6419:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Y}});var n=t(1840),r=t(5458),a=t(673),i=t(1070),l=t(776),o=t(1160),c=t(1318),d=t(8136),u=t(995),m=t(1174),h=t(6374),p=t(6637),x=t(181),g=t(8332),j=t(4740),v=t(7917),f=t(5023),b=t(4620),w=t(4591),y=t(7890),A=t(2573),C=t(175),S=t(917);let P=(0,t(8787).Ue)(e=>({open:!1,setOpen:s=>e({open:s,edit:null}),edit:null,setEdit:s=>e({edit:s,open:!0}),delete:null,setDelete:s=>e({delete:s}),rcon:null,setRcon:s=>e({rcon:s})}));var k=t(772),E=t(1916),R=t(7040),N=t(964),Z=t(7743),z=t(8826),O=t(3681),I=t(4838);let D=["changelevel","sa_kick","sa_ban"];var F=()=>{let e=P(e=>e.rcon),s=P(e=>e.setRcon),[t,r]=(0,j.useState)([]),[a,i]=(0,j.useState)(""),[l,o]=(0,j.useState)(!1),c=e=>{switch(e.key){case"Tab":e.continuePropagation(),e.preventDefault();let s=D.filter(e=>e.toLowerCase().startsWith(a));s.length>0&&i(s[0]);break;case"ArrowUp":e.continuePropagation(),e.preventDefault();let n=t.filter(e=>"USER"===e.type),r=n[n.length-1];r&&i(r.message);break;case"Enter":d()}},d=async()=>{if(!l){if(!a)return A.Am.error("Please write a command!");if(a.length<2)return A.Am.error("Command is too short!");o(!0),r(e=>[...e,{message:a,type:"USER"}]);try{let s=await (0,E.Z)("/api/admin/servers/".concat(e),{method:"POST",data:{message:a}});r(e=>{var t;return[...e,{message:(null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.response)?s.data.response:"Unknown Response",type:"SERVER"}]}),i("")}catch(e){console.error(e),A.Am.error("Failed to send command!")}o(!1)}};return(0,n.jsx)(R.R,{isOpen:!!e,onOpenChange:l?void 0:()=>s(null),size:"2xl",children:(0,n.jsx)(N.A,{children:e=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.k,{className:"flex flex-col gap-1",children:"RCON Panel"}),(0,n.jsxs)(z.I,{className:"py-4",children:[(0,n.jsx)("ul",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.map(e=>(0,n.jsx)("li",{className:"ms-auto flex justify-end gap-x-2 sm:gap-x-4",children:(0,n.jsx)("div",{className:"grow ".concat("USER"===e.type?"text-start":"text-end"," space-y-3"),children:(0,n.jsx)("div",{className:"inline-block ".concat("USER"===e.type?"bg-blue-600":"bg-orange-500"," rounded-2xl p-2 px-4 shadow-sm"),children:(0,n.jsx)("p",{className:"text-sm text-white",children:e.message})})})},e.message))}),(0,n.jsx)(O.d,{label:"Command",variant:"faded",defaultItems:D.map(e=>({label:e,value:e})),startContent:(0,n.jsx)("span",{className:"text-sm text-slate-500",children:"$"}),placeholder:"Write a command or use the autocomplete",description:'Press "Tab" to autocomplete',inputValue:a||"",onInputChange:i,onSelectionChange:e=>i(e),isLoading:l,onKeyDown:c,allowsCustomValue:!0,autoFocus:!0,fullWidth:!0,children:e=>(0,n.jsx)(I.R,{children:e.label},e.value)})]})]})})})},M=()=>{let e=P(e=>e.setEdit),s=P(e=>e.delete),t=P(e=>e.setDelete),r=P(e=>e.setRcon),a=async()=>{if(s){try{await (0,E.Z)("/api/admin/servers/".concat(s.id),{method:"DELETE"}),A.Am.success("Succesfully deleted server!"),await (0,S.JG)("/api/admin/servers")}catch(s){var e;A.Am.error(null!==(e=s.response.data)&&void 0!==e?e:"Failed to delete server!")}t(null)}},{data:i,isLoading:o}=(0,S.ZP)("/api/admin/servers",C.Z,{keepPreviousData:!0}),c=o||(null==i?void 0:i.length)===0?"loading":"idle",d=(0,j.useCallback)((s,a)=>{switch(a){case"id":return(0,n.jsx)(f.z,{variant:"flat",size:"sm",children:s.id});case"hostname":case"address":return(0,n.jsx)("div",{children:s[a]});case"actions":return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(l.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>e(s),children:[(0,n.jsx)(b.Z,{size:16}),"Edit Server"]}),(0,n.jsxs)(l.A,{size:"sm",variant:"flat",color:"danger",onClick:()=>t(s),children:[(0,n.jsx)(w.Z,{size:16}),"Delete Server"]}),(0,n.jsxs)(l.A,{size:"sm",variant:"flat",color:"default",onClick:()=>r(s.id),children:[(0,n.jsx)(y.Z,{size:16}),"RCON"]})]});default:return(0,n.jsx)(n.Fragment,{children:"Error!"})}},[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(u.b,{children:[(0,n.jsxs)(m.J,{children:[(0,n.jsx)(h.j,{children:"ID"},"id"),(0,n.jsx)(h.j,{children:"Hostname"},"hostname"),(0,n.jsx)(h.j,{children:"Address"},"address"),(0,n.jsx)(h.j,{children:"Actions"},"actions")]}),(0,n.jsx)(p.y,{items:null!=i?i:[],loadingContent:(0,n.jsx)(v.c,{}),loadingState:c,children:e=>(0,n.jsx)(x.g,{children:s=>(0,n.jsx)(g.X,{children:d(e,s)})},e.id)})]}),(0,n.jsx)(k.Z,{open:!!s,onAction:a,onCancel:()=>t(null),title:"Delete server",text:(0,n.jsxs)("p",{children:["Are you sure you want to delete: ",(0,n.jsx)("b",{children:null==s?void 0:s.hostname})," server?"]})}),(0,n.jsx)(F,{})]})},_=t(5370),T=t(7670),U=t(9954),L=t(7463),G=t(1326);let J=G.z.object({address:G.z.string().refine(e=>e.includes(":"),{message:"IP Address must include a port number"}),hostname:G.z.string().min(3),rcon:G.z.string().min(0).optional()});var V=()=>{let e=P(e=>e.open),s=P(e=>e.edit),t=P(e=>e.setOpen),[r,a]=(0,j.useState)(!1),i=async()=>{if(!r){a(!0);try{await (0,E.Z)(s?"/api/admin/servers/".concat(s.id):"/api/admin/servers",{method:s?"PUT":"POST",data:o.values}),await (0,S.JG)("/api/admin/servers"),A.Am.success(s?"Succesfully edited server!":"Succesfully created server!"),t(!1)}catch(e){console.error(e),A.Am.error("Failed to ".concat(s?"edit":"create"," server!"))}a(!1)}},o=(0,_.c)({initialValues:{address:s?s.address:"",hostname:s?s.hostname:"",rcon:s?s.rcon:""},validate:(0,T.F)(J)});return(0,j.useEffect)(()=>{o.setValues({address:s?s.address:"",hostname:s?s.hostname:"",rcon:s?s.rcon:""})},[s]),(0,n.jsx)(R.R,{isOpen:e,onOpenChange:r?void 0:t,children:(0,n.jsx)(N.A,{children:e=>(0,n.jsxs)("form",{onSubmit:o.onSubmit(i),children:[(0,n.jsx)(Z.k,{className:"flex flex-col gap-1",children:s?"Edit server":"Create new server"}),(0,n.jsxs)(z.I,{children:[(0,n.jsx)(L.Y,{...o.getInputProps("hostname"),errorMessage:o.errors.hostname,label:"Hostname",placeholder:"My cs2 server",variant:"bordered",disabled:r,autoFocus:!0}),(0,n.jsx)(L.Y,{...o.getInputProps("address"),errorMessage:o.errors.address,label:"Address",placeholder:"1.1.1.1:25565",type:"text",variant:"bordered",disabled:r}),(0,n.jsx)(L.Y,{...o.getInputProps("rcon"),errorMessage:o.errors.rcon,label:"Rcon Password",placeholder:"123456789",type:"password",variant:"bordered",disabled:r})]}),(0,n.jsxs)(U.R,{children:[(0,n.jsx)(l.A,{color:"danger",variant:"flat",onPress:e,disabled:r,children:"Cancel"}),(0,n.jsx)(l.A,{color:"primary",type:"submit",isLoading:r,children:s?"Edit server":"Create new server"})]})]})})})},W=t(7512),Y=()=>{let e=P(e=>e.setOpen),s=(0,c.usePathname)(),t=d.ADMIN_TABS.find(e=>e.path===s);return(0,n.jsx)(W.default,{flags:(null==t?void 0:t.permissions)||[],children:(0,n.jsxs)(r.w,{children:[(0,n.jsxs)(a.u,{className:"text-2xl font-medium flex flex-row justify-between",children:["Manage Servers",(0,n.jsxs)(l.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>e(!0),children:[(0,n.jsx)(o.Z,{}),"Add new server"]})]}),(0,n.jsx)(i.G,{children:(0,n.jsx)(M,{})}),(0,n.jsx)(V,{})]})})}},772:function(e,s,t){"use strict";var n=t(1840),r=t(776),a=t(7040),i=t(964),l=t(7743),o=t(8826),c=t(9954);s.Z=e=>{let{open:s,title:t,text:d,onAction:u,onCancel:m}=e;return(0,n.jsx)(a.R,{isOpen:s,onOpenChange:m,children:(0,n.jsx)(i.A,{children:e=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.k,{className:"flex flex-col gap-1",children:t}),(0,n.jsx)(o.I,{children:d}),(0,n.jsxs)(c.R,{children:[(0,n.jsx)(r.A,{color:"default",variant:"flat",onPress:e,children:"Cancel"}),(0,n.jsx)(r.A,{color:"primary",type:"submit",onClick:u,children:t})]})]})})})}},175:function(e,s,t){"use strict";var n=t(1916);s.Z=e=>n.Z.get(e).then(e=>e.data)},646:function(e,s,t){"use strict";t.d(s,{hY:function(){return l},jc:function(){return o}});var n=t(2573),r=t(917),a=t(175),i=t(1916);let l=async()=>{await (0,i.Z)("/api/auth/logout"),await (0,r.JG)("/api/auth"),n.Am.success("Logged out successfully")},o=()=>{let e=window.innerWidth/2-300,s=window.innerHeight/2-400,t=window.open("/api/auth/login/","","toolbar=no, location=no, directories=no, status=no, menubar=no, \n		  scrollbars=no, resizable=yes, copyhistory=no, width=".concat(600,", \n		  height=").concat(800,", top=").concat(s,", left=").concat(e)),a=setInterval(async()=>{t&&t.closed&&(await (0,r.JG)("/api/auth"),n.Am.success("Logged in successfully!"),clearInterval(a))},1e3)};s.ZP=()=>{let{data:e,isLoading:s,error:t}=(0,r.ZP)("/api/auth",a.Z);return e&&e.admin&&e.admin.group&&(e.admin.flags=e.admin.group.flags,e.admin.immunity=e.admin.group.immunity),{user:t||!e?null:e.user,admin:t||!e?null:e.admin,isLoading:s}}}},function(e){e.O(0,[1356,298,3277,4594,2150,5792,2298,839,9741,4672,7819,9869,6810,7942,1784,1744],function(){return e(e.s=949)}),_N_E=e.O()}]);