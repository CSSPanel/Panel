(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8710],{7722:function(e,s,t){Promise.resolve().then(t.bind(t,8872))},679:function(e,s,t){"use strict";var n=t(2412),r=t(165),a=t(5979),i=t(1402),l=t(4837);s.default=e=>{let{children:s,flags:t}=e,{admin:o,isLoading:d}=(0,l.ZP)(),c=(0,a.useRouter)();return(0,i.useEffect)(()=>{if(!d&&(!o||t.length>0&&!t.some(e=>{var s;return null===(s=o.flags)||void 0===s?void 0:s.includes(e)})))return c.push("/")},[o,d,c,t]),d?(0,n.jsx)(r.c,{}):o?(0,n.jsx)(n.Fragment,{children:s}):(0,n.jsx)(n.Fragment,{children:"No Access"})}},4773:function(e,s,t){"use strict";t.d(s,{r:function(){return o}});var n=t(2412),r=t(5979),a=t(8365),i=t(3327),l=t(4837);s.default=()=>{let e=(0,r.usePathname)(),s=(0,r.useRouter)(),{admin:t}=(0,l.ZP)(),d=(null==t?void 0:t.flags)||[],c=o.filter(e=>e.permissions.some(e=>d.includes(e)));return(0,n.jsx)(a.n,{"aria-label":"Admin-tabs",selectedKey:e,onSelectionChange:e=>s.push(e),items:c,children:e=>(0,n.jsx)(i.r,{title:e.title},e.path)})};let o=[{path:"/admin",title:"Statistics",permissions:["@web/root","@web/logs","@css/root","@web/stats"]},{path:"/admin/modules",title:"Modules",permissions:["@web/root","@css/root"]},{path:"/admin/admins",title:"Manage Admins",permissions:["@web/root","@css/root","@web/admins"]},{path:"/admin/servers",title:"Manage Servers",permissions:["@web/root","@css/root","@web/servers"]},{path:"/admin/bans",title:"Manage Bans",permissions:["@web/root","@css/root","@web/bans"]},{path:"/admin/mutes",title:"Manage Mutes",permissions:["@web/root","@css/root","@web/mutes"]},{path:"/admin/logs",title:"Logs",permissions:["@web/root","@css/root","@web/logs"]},{path:"/admin/settings",title:"Panel Settings",permissions:["@web/root","@css/root"]}]},8872:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return K}});var n=t(2412),r=t(7284),a=t(2409),i=t(593),l=t(8751),o=t(8882),d=t(5979),c=t(4773),u=t(7296),h=t(1358),m=t(8134),p=t(9688),x=t(6574),g=t(1365),f=t(1402),j=t(165),v=t(6418),b=t(172),w=t(7864),y=t(3425),A=t(5414),C=t(1920),P=t(1281);let S=(0,t(2160).Ue)(e=>({open:!1,setOpen:s=>e({open:s,edit:null}),edit:null,setEdit:s=>e({edit:s,open:!0}),delete:null,setDelete:s=>e({delete:s}),rcon:null,setRcon:s=>e({rcon:s})}));var k=t(9476),E=t(52),R=t(3733),N=t(9940),Z=t(2876),z=t(4226),O=t(1739),F=t(4690);let I=["changelevel","sa_kick","sa_ban"];var D=()=>{let e=S(e=>e.rcon),s=S(e=>e.setRcon),[t,r]=(0,f.useState)([]),[a,i]=(0,f.useState)(""),[l,o]=(0,f.useState)(!1);(0,f.useEffect)(()=>{r([])},[e]);let d=e=>{switch(e.key){case"Tab":e.continuePropagation(),e.preventDefault();let s=I.filter(e=>e.toLowerCase().startsWith(a));s.length>0&&i(s[0]);break;case"ArrowUp":e.continuePropagation(),e.preventDefault();let n=t.filter(e=>"USER"===e.type),r=n[n.length-1];r&&i(r.message);break;case"Enter":c()}},c=async()=>{if(!l){if(!a)return A.Am.error("Please write a command!");if(a.length<2)return A.Am.error("Command is too short!");o(!0),r(e=>[...e,{message:a,type:"USER"}]);try{let s=await (0,E.Z)("/api/admin/servers/".concat(e),{method:"POST",data:{message:a}});r(e=>{var t;return[...e,{message:(null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.response)?s.data.response:"Unknown Response",type:"SERVER"}]}),i("")}catch(e){console.error(e),A.Am.error("Failed to send command, make sure the server is online!")}o(!1)}};return(0,n.jsx)(R.R,{isOpen:!!e,onOpenChange:l?void 0:()=>s(null),size:"2xl",children:(0,n.jsx)(N.A,{children:e=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.k,{className:"flex flex-col gap-1",children:"RCON Panel"}),(0,n.jsxs)(z.I,{className:"py-4",children:[(0,n.jsx)("ul",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.map(e=>(0,n.jsx)("li",{className:"ms-auto flex justify-end gap-x-2 sm:gap-x-4",children:(0,n.jsx)("div",{className:"grow ".concat("USER"===e.type?"text-start":"text-end"," space-y-3"),children:(0,n.jsx)("div",{className:"inline-block ".concat("USER"===e.type?"bg-blue-600":"bg-orange-500"," rounded-2xl p-2 px-4 shadow-sm"),children:(0,n.jsx)("p",{className:"text-sm text-white",children:e.message})})})},e.message))}),(0,n.jsx)(O.d,{label:"Command",variant:"faded",defaultItems:I.map(e=>({label:e,value:e})),startContent:(0,n.jsx)("span",{className:"text-sm text-slate-500",children:"$"}),placeholder:"Write a command or use the autocomplete",description:'Press "Tab" to autocomplete',inputValue:a||"",onInputChange:i,onSelectionChange:e=>i(e),isLoading:l,onKeyDown:d,allowsCustomValue:!0,autoFocus:!0,fullWidth:!0,children:e=>(0,n.jsx)(F.R,{children:e.label},e.value)})]})]})})})},M=()=>{let e=S(e=>e.setEdit),s=S(e=>e.delete),t=S(e=>e.setDelete),r=S(e=>e.setRcon),a=async()=>{if(s){try{await (0,E.Z)("/api/admin/servers/".concat(s.id),{method:"DELETE"}),A.Am.success("Succesfully deleted server!"),await (0,P.JG)("/api/admin/servers")}catch(s){var e;A.Am.error(null!==(e=s.response.data)&&void 0!==e?e:"Failed to delete server!")}t(null)}},{data:i,isLoading:o}=(0,P.ZP)("/api/admin/servers",C.Z,{keepPreviousData:!0}),d=o||(null==i?void 0:i.length)===0?"loading":"idle",c=(0,f.useCallback)((s,a)=>{switch(a){case"id":return(0,n.jsx)(v.z,{variant:"flat",size:"sm",children:s.id});case"hostname":case"address":return(0,n.jsx)("div",{children:s[a]});case"actions":return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(l.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>e(s),children:[(0,n.jsx)(b.Z,{size:16}),"Edit Server"]}),(0,n.jsxs)(l.A,{size:"sm",variant:"flat",color:"danger",onClick:()=>t(s),children:[(0,n.jsx)(w.Z,{size:16}),"Delete Server"]}),(0,n.jsxs)(l.A,{size:"sm",variant:"flat",color:"default",onClick:()=>r(s.id),isDisabled:!s.rcon,children:[(0,n.jsx)(y.Z,{size:16}),"RCON"]})]});default:return(0,n.jsx)(n.Fragment,{children:"Error!"})}},[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(u.b,{children:[(0,n.jsxs)(h.J,{children:[(0,n.jsx)(m.j,{children:"ID"},"id"),(0,n.jsx)(m.j,{children:"Hostname"},"hostname"),(0,n.jsx)(m.j,{children:"Address"},"address"),(0,n.jsx)(m.j,{children:"Actions"},"actions")]}),(0,n.jsx)(p.y,{items:null!=i?i:[],loadingContent:(0,n.jsx)(j.c,{}),loadingState:d,children:e=>(0,n.jsx)(x.g,{children:s=>(0,n.jsx)(g.X,{children:c(e,s)})},e.id)})]}),(0,n.jsx)(k.Z,{open:!!s,onAction:a,onCancel:()=>t(null),title:"Delete server",text:(0,n.jsxs)("p",{children:["Are you sure you want to delete: ",(0,n.jsx)("b",{children:null==s?void 0:s.hostname})," server?"]})}),(0,n.jsx)(D,{})]})},_=t(2167),U=t(5939),L=t(4093),V=t(889),T=t(5440);let G=T.z.object({address:T.z.string().refine(e=>e.includes(":"),{message:"IP Address must include a port number"}),hostname:T.z.string().min(3),rcon:T.z.string().min(0).optional(),hidden:T.z.boolean().optional()});var H=t(3806),J=t(5087),W=()=>{let e=S(e=>e.open),s=S(e=>e.edit),t=S(e=>e.setOpen),[r,a]=(0,f.useState)(!1),i=async()=>{if(!r){a(!0);try{await (0,E.Z)(s?"/api/admin/servers/".concat(s.id):"/api/admin/servers",{method:s?"PUT":"POST",data:o.values}),await (0,P.JG)("/api/admin/servers"),A.Am.success(s?"Succesfully edited server!":"Succesfully created server!"),t(!1)}catch(e){console.error(e),A.Am.error("Failed to ".concat(s?"edit":"create"," server!"))}a(!1)}},o=(0,U.c)({initialValues:{address:s?s.address:"",hostname:s?s.hostname:"",rcon:s?s.rcon:"",hidden:!!s&&s.hidden},validate:(0,L.F)(G)});return(0,f.useEffect)(()=>{o.setValues({address:s?s.address:"",hostname:s?s.hostname:"",rcon:s?s.rcon:"",hidden:!!s&&s.hidden})},[s]),(0,n.jsx)(R.R,{isOpen:e,onOpenChange:r?void 0:t,children:(0,n.jsx)(N.A,{children:e=>(0,n.jsxs)("form",{onSubmit:o.onSubmit(i),children:[(0,n.jsx)(Z.k,{className:"flex flex-col gap-1",children:s?"Edit server":"Create new server"}),(0,n.jsxs)(z.I,{children:[!s&&(0,n.jsxs)("p",{children:["Before creating the server, note that the"," ",(0,n.jsx)(H.default,{href:"https://github.com/csspanel/plugin",target:"_blank",className:"underline",children:"plugin"})," ","should do that automatically, if it didnt please make sure its installed correctly!"]}),(0,n.jsx)(V.Y,{...o.getInputProps("hostname"),errorMessage:o.errors.hostname,label:"Hostname",placeholder:"My cs2 server",variant:"bordered",disabled:r,autoFocus:!0}),(0,n.jsx)(V.Y,{...o.getInputProps("address"),errorMessage:o.errors.address,label:"Address",placeholder:"1.1.1.1:25565",type:"text",variant:"bordered",disabled:r}),(0,n.jsx)(V.Y,{...o.getInputProps("rcon"),errorMessage:o.errors.rcon,label:"Rcon Password",placeholder:"123456789",type:"password",variant:"bordered",disabled:r}),(0,n.jsx)(J.K,{...o.getInputProps("hidden"),title:"Hidden",isSelected:o.values.hidden,onValueChange:e=>o.setFieldValue("hidden",e),disabled:r,children:"Hidden?"})]}),(0,n.jsxs)(_.R,{children:[(0,n.jsx)(l.A,{color:"danger",variant:"flat",onPress:e,disabled:r,children:"Cancel"}),(0,n.jsx)(l.A,{color:"primary",type:"submit",isLoading:r,children:s?"Edit server":"Create new server"})]})]})})})},Y=t(679),K=()=>{let e=S(e=>e.setOpen),s=(0,d.usePathname)(),t=c.r.find(e=>e.path===s);return(0,n.jsx)(Y.default,{flags:(null==t?void 0:t.permissions)||[],children:(0,n.jsxs)(r.w,{children:[(0,n.jsxs)(a.u,{className:"text-2xl font-medium flex flex-row justify-between",children:["Manage Servers",(0,n.jsxs)(l.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>e(!0),children:[(0,n.jsx)(o.Z,{}),"Create new server"]})]}),(0,n.jsx)(i.G,{children:(0,n.jsx)(M,{})}),(0,n.jsx)(W,{})]})})}},9476:function(e,s,t){"use strict";var n=t(2412),r=t(8751),a=t(3733),i=t(9940),l=t(2876),o=t(4226),d=t(2167);s.Z=e=>{let{open:s,title:t,text:c,onAction:u,onCancel:h}=e;return(0,n.jsx)(a.R,{isOpen:s,onOpenChange:h,children:(0,n.jsx)(i.A,{children:e=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.k,{className:"flex flex-col gap-1",children:t}),(0,n.jsx)(o.I,{children:c}),(0,n.jsxs)(d.R,{children:[(0,n.jsx)(r.A,{color:"default",variant:"flat",onPress:e,children:"Cancel"}),(0,n.jsx)(r.A,{color:"primary",type:"submit",onClick:u,children:t})]})]})})})}},1920:function(e,s,t){"use strict";var n=t(52);s.Z=e=>n.Z.get(e).then(e=>e.data)},4837:function(e,s,t){"use strict";t.d(s,{hY:function(){return l},jc:function(){return o}});var n=t(5414),r=t(1281),a=t(1920),i=t(52);let l=async()=>{await (0,i.Z)("/api/auth/logout"),await (0,r.JG)("/api/auth"),n.Am.success("Logged out successfully")},o=()=>{let e=window.innerWidth/2-300,s=window.innerHeight/2-400,t=window.open("/api/auth/login/","","toolbar=no, location=no, directories=no, status=no, menubar=no, \n		  scrollbars=no, resizable=yes, copyhistory=no, width=".concat(600,", \n		  height=").concat(800,", top=").concat(s,", left=").concat(e)),a=setInterval(async()=>{t&&t.closed&&(await (0,r.JG)("/api/auth"),n.Am.success("Logged in successfully!"),clearInterval(a))},1e3)};s.ZP=()=>{let{data:e,isLoading:s,error:t}=(0,r.ZP)("/api/auth",a.Z);return e&&e.admin&&e.admin.group&&(e.admin.flags=e.admin.group.flags,e.admin.immunity=e.admin.group.immunity),{user:t||!e?null:e.user,admin:t||!e?null:e.admin,isLoading:s}}}},function(e){e.O(0,[687,2879,9208,1281,5414,6187,2163,1094,3806,5440,8663,5226,5204,3182,9097,5396,5658,8513,3866,7416,1744],function(){return e(e.s=7722)}),_N_E=e.O()}]);