"use strict";(()=>{var e={};e.id=6725,e.ids=[6725],e.modules={62418:e=>{e.exports=require("mysql2/promise")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},99648:e=>{e.exports=import("axios")},97564:e=>{e.exports=import("chalk")},2782:e=>{e.exports=import("steam-api-sdk")},9926:e=>{e.exports=import("zod")},57147:e=>{e.exports=require("fs")},71017:e=>{e.exports=require("path")},58883:(e,t,r)=>{r.a(e,async(e,i)=>{try{r.r(t),r.d(t,{config:()=>l,default:()=>p,routeModule:()=>d});var n=r(20114),s=r(32128),a=r(57797),o=r(60407),m=e([o]);o=(m.then?(await m)():m)[0];let p=(0,a.l)(o,"default"),l=(0,a.l)(o,"config"),d=new n.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/admin/setup",pathname:"/api/admin/setup",bundlePath:"",filename:""},userland:o});i()}catch(e){i(e)}})},60407:(e,t,r)=>{r.a(e,async(e,i)=>{try{r.r(t),r.d(t,{default:()=>c});var n=r(18011),s=r(57147),a=r.n(s),o=r(71017),m=r.n(o),p=r(48874),l=e([n,p]);[n,p]=l.then?(await l)():l;let d=async(e,t)=>{let{method:r}=e;if("POST"===r)try{let r=n.Z.parse(e.body);r.SESSION_SECRET=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),Object.keys(r).forEach(e=>{u(e,r[e])}),await p.Z?.admins.create({player_steamid:r.MASTER_ADMIN,player_name:"Master Admin",flags:["@css/root","@web/root"],immunity:"100",server_id:null,servers_groups:null}),log("Setup complete!"),t.status(200).send("ok"),process.exit(1)}catch(e){return error(e),t.status(500).json(e)}return t.status(405).end()},u=(e,t)=>{let r=m().join(process.cwd(),".env");a().existsSync(r)||a().writeFileSync(r,"");let i=a().readFileSync(".env","utf8"),n=RegExp(`^${e}=.*$`,"m");n.test(i)?i=i.replace(n,`${e}="${t}"`):i+=`${e}="${t}"
`,a().writeFileSync(".env",i)},c=d;i()}catch(e){i(e)}})},18011:(e,t,r)=>{r.a(e,async(e,i)=>{try{r.d(t,{Z:()=>m,z:()=>o});var n=r(9926),s=e([n]);let a=(n=(s.then?(await s)():s)[0]).z.object({STEAM_API_KEY:n.z.string().min(1),SESSION_SECRET:n.z.string().min(1).optional(),DOMAIN:n.z.string().min(1),DB_HOST:n.z.string().min(1),DB_USER:n.z.string().min(1),DB_PASSWORD:n.z.string().min(1),DB_DATABASE:n.z.string().min(1),DB_PORT:n.z.string().min(1),MASTER_ADMIN:n.z.string().min(1)}),o=n.z.object({DB_HOST:n.z.string().min(1),DB_USER:n.z.string().min(1),DB_PASSWORD:n.z.string().min(1),DB_DATABASE:n.z.string().min(1),DB_PORT:n.z.string().min(1)}),m=a;i()}catch(e){i(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[6941],()=>r(58883));module.exports=i})();