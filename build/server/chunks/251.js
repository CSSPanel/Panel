"use strict";exports.id=251,exports.ids=[251],exports.modules={80131:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(98284),a=n(34002),r=n(76425),i=n(1902),l=n(16490),o=n(61524),d=n(72150);let c=({open:e,children:t,action:n,handleClose:c,isLoading:m,actionText:u})=>s.jsx(a.R,{isOpen:e,onOpenChange:!m&&c||void 0,classNames:{backdrop:"z-[20000]",wrapper:"z-[20000]"},children:s.jsx(r.A,{children:e=>(0,s.jsxs)(s.Fragment,{children:[s.jsx(i.k,{className:"flex flex-col gap-1",children:"Confirmation"}),s.jsx(l.I,{children:t}),(0,s.jsxs)(o.R,{children:[s.jsx(d.A,{color:"primary",variant:"light",onPress:e,isLoading:m,children:"Cancel"}),s.jsx(d.A,{color:"primary",onPress:n,isLoading:m,children:u||"Confirm"})]})]})})})},55719:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(98284),a=n(92300),r=n(44984).$0,i=n(52183),l=n(22173);let o=(e,t)=>{(0,l.useEffect)(()=>{let n=n=>{let s=e?.current;!s||s.contains(n.target)||t(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}},[e,t])};var d=n(45246);let c=({open:e,x:t,y:n,handleCloseMenu:c,items:m})=>{let u=(0,l.useRef)(null);return o(u,c),e&&s.jsx(d.E.div,{className:"w-full max-w-[260px] border-small px-1 py-0.5 rounded-small bg-background/40 backdrop-blur-lg border-default-200 absolute z-[20000]",style:{left:t,top:n},ref:u,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.08},children:s.jsx(a.X,{variant:"flat","aria-label":"Listbox menu with sections",items:m,children:m.map(({category:e,items:t})=>s.jsx(r,{title:e,children:t.map(({key:e,description:t,icon:n,color:a,onClick:r})=>s.jsx(i.R,{description:s.jsx("span",{className:"text-foreground-700",children:t}),startContent:s.jsx(n,{}),color:a||"default",onClick:()=>{r&&r(),c()},children:e},e))},e))})})}},251:(e,t,n)=>{n.r(t),n.d(t,{MUTE_OPTIONS:()=>K,default:()=>H});var s=n(98284),a=n(69501),r=n(83701),i=n(44375),l=n(78447),o=n(72178),d=n(43807),c=n(22173),m=n(77438),u=n(52183),h=n(86276),x=n(58510),j=n(37297),p=n(70627),g=n(27083),y=n(61756),v=n(73553),f=n(36065),b=n(42685),w=n(66819),T=n(48768),C=n(73876),E=n(72150),z=n(31755),M=n(85615);let P=e=>{switch(e){case"ACTIVE":return s.jsx(v.z,{color:"danger",size:"sm",variant:"flat",radius:"sm",children:"Active"});case"EXPIRED":return s.jsx(v.z,{color:"success",size:"sm",variant:"flat",radius:"sm",children:"Expired"});case"UNMUTED":return s.jsx(v.z,{color:"secondary",size:"sm",variant:"flat",radius:"sm",children:"Removed"});default:return s.jsx(v.z,{color:"secondary",size:"sm",variant:"flat",radius:"sm",children:"Unknown"})}};var N=n(80823),D=n(11168),R=n(41278),_=n(11082),S=n(46705),Z=n(70059),L=n(55719),A=n(80131),k=n(85733),U=n(74591),I=n(34002),X=n(76425),Y=n(1902),$=n(16490),F=n(61524),O=n(94608);let V=({open:e,setOpen:t,mutate:n})=>{let[a,r]=(0,c.useState)(!1),i=async()=>{if(!a){r(!0);try{await (0,D.Z)("/api/mutes",{method:"POST",data:l.values}),await n(),R.Am.success("Succesfully muted player!"),t(!1)}catch(t){let e=t?.response?.data||t?.message;console.error(t),R.Am.error(`Failed to create mute!
${e||t}`)}r(!1)}},l=(0,k.c)({initialValues:{player_steamid:"",reason:"",duration:"",comment:"",type:"MUTE"},validate:(0,U.F)(O.Z)});return s.jsx(I.R,{isOpen:e,onOpenChange:a?void 0:t,children:s.jsx(X.A,{children:e=>(0,s.jsxs)("form",{onSubmit:l.onSubmit(i),children:[s.jsx(Y.k,{className:"flex flex-col gap-1",children:"Create new mute"}),(0,s.jsxs)($.I,{children:[s.jsx(y.Y,{...l.getInputProps("player_steamid"),errorMessage:l.errors.player_steamid,label:"Player Steam64 / SteamId / Profile URL",placeholder:"7656XXXXXX",variant:"bordered",isDisabled:a,autoFocus:!0}),s.jsx(m.g,{label:"Type",placeholder:"Select the mute type",selectedKeys:[l.values.type],onChange:e=>l.setValues({type:e.target.value}),isDisabled:a,disallowEmptySelection:!0,children:K.map(e=>s.jsx(u.R,{value:e.value,children:e.name},e.value))}),s.jsx(y.Y,{...l.getInputProps("reason"),errorMessage:l.errors.reason,label:"Reason (min 3 characters)",placeholder:"Cheating / Griefing / Toxicity / etc.",variant:"bordered",isDisabled:a}),s.jsx(y.Y,{...l.getInputProps("duration"),errorMessage:l.errors.duration,label:"Duration in minutes",placeholder:"for example, 60",description:"0 for permanent",variant:"bordered",type:"number",isDisabled:a}),s.jsx(y.Y,{...l.getInputProps("comment"),errorMessage:l.errors.comment,label:"Comment (optional)",variant:"bordered",isDisabled:a}),(0,s.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,s.jsxs)("span",{children:["The mute will start now ",(0,s.jsxs)("b",{children:["(",(0,_.Z)(),")"]})]}),(0,s.jsxs)("span",{children:["and will end at"," ",s.jsx("b",{children:"0"===l.values.duration?s.jsx("b",{className:"text-red-700",children:"Permanent"}):(0,_.Z)(new Date().getTime()+6e4*Number(l.values.duration))})]})]})]}),(0,s.jsxs)(F.R,{children:[s.jsx(E.A,{color:"danger",variant:"flat",onPress:e,isDisabled:a,children:"Cancel"}),s.jsx(E.A,{color:"primary",type:"submit",isLoading:a,children:"Mute player"})]})]})})})};var G=n(2193),W=n(4570);let J=(0,G.Ue)(e=>({action:null,setAction:t=>e({action:t}),isLoading:!1,setIsLoading:t=>e({isLoading:t}),details:null,setDetails:t=>e({details:t}),reset:()=>e({action:null,isLoading:!1,details:null})}));W.z.object({reason:W.z.string()}),W.z.object({reason:W.z.string(),duration:W.z.string(),type:O.P}),W.z.object({comment:W.z.string()}),W.z.object({reason:W.z.string(),duration:W.z.string(),type:O.P}),W.z.enum(["unmute","remute","comment","edit","delete"]);let K=[{name:"Gag (Chat)",value:"GAG"},{name:"Mute (Voice)",value:"MUTE"},{name:"Silence (Both)",value:"SILENCE"}],H=({type:e})=>{let[t,n]=(0,c.useState)(!1),[k,U]=(0,c.useState)(1),I=10;"/"===(0,f.usePathname)()&&(I=5);let{data:X,isLoading:Y,mutate:$}=(0,M.ZP)(`/api/mutes?page=${k}&rows=${I}`,z.Z,{keepPreviousData:!0}),F=(0,c.useMemo)(()=>X?.count?Math.ceil(X.count/I):0,[X?.count,I]),{admin:O}=(0,S.ZP)(),{x:G,y:W,open:H,handleCloseMenu:B,handleOpen:q,info:Q}=(0,Z.Z)(),ee=J(e=>e.action),et=J(e=>e.setAction),en=J(e=>e.details),es=J(e=>e.setDetails),ea=J(e=>e.isLoading),er=J(e=>e.setIsLoading),ei=J(e=>e.reset),el=async()=>{if(ee&&!ea&&Q){er(!0);try{await D.Z.post(`/api/mutes/${Q.id}`,{action:ee,details:en}),await $(),ei(),R.ZP.success(`Player ${ee}ed successfully`)}catch(e){R.ZP.error(`Error ${ee} player`)}er(!1)}},eo=(e,t)=>{switch(t){case"player_name":return s.jsx(N.default,{href:`https://steamcommunity.com/profiles/${e.player_steamid}`,target:"_blank",passHref:!0,children:s.jsx(g.z,{avatarProps:{radius:"lg",src:e.player_avatar||""},name:e.player_name,children:e.player_name?.slice(0,10)})});case"status":return P(e.status);case"reason":return e.reason.length>10?s.jsx(p.e,{content:e.reason,showArrow:!0,children:s.jsx("div",{className:"text-xs font-light",children:e.reason.slice(0,10)})}):s.jsx("div",{className:"text-xs font-light",children:e.reason});case"unmute_reason":return e.unmute_reason&&e.unmute_reason.length>10?s.jsx(p.e,{content:e.unmute_reason,showArrow:!0,children:s.jsx("div",{className:"text-xs font-light",children:e.unmute_reason?.slice(0,10)})}):s.jsx("div",{className:"text-xs font-light",children:e.unmute_reason});case"type":return s.jsx(v.z,{color:"secondary",size:"sm",variant:"flat",radius:"sm",children:e.type});case"duration":return s.jsx(v.z,{color:"primary",size:"sm",variant:"flat",radius:"sm",children:0===e.duration?"Permanent":`${e.duration} minutes`});case"admin_name":return e.admin_name?"Console"===e.admin_name?s.jsx(v.z,{color:"danger",size:"sm",variant:"flat",radius:"sm",children:"Console"}):s.jsx(N.default,{href:`https://steamcommunity.com/profiles/${e.admin_steamid}`,target:"_blank",passHref:!0,children:s.jsx(g.z,{avatarProps:{radius:"lg",src:e.admin_avatar||""},name:e.admin_name,children:e.admin_name})}):s.jsx(s.Fragment,{children:"-"});case"timeLeft":if(0===e.duration)return s.jsx(v.z,{color:"danger",size:"sm",variant:"flat",radius:"sm",children:"Permanent"});if("UNMUTED"===e.status||"EXPIRED"===e.status)return s.jsx(x.W,{color:"success",value:100,isStriped:!0});let n=new Date,a=new Date(e.created),r=new Date(e.ends),i=Math.round((n.getTime()-a.getTime())/(r.getTime()-a.getTime())*100)||0,l=Math.round((r.getTime()-n.getTime())/6e4),o=i<50?"warning":i>=100?"success":"primary";return l>0?s.jsx(p.e,{content:`${l} minutes left`,color:o,showArrow:!0,children:s.jsx(x.W,{color:o,value:i,isStriped:!0})}):s.jsx(x.W,{color:o,value:i,isStriped:!0});case"comment":return e.comment?e.comment.length>10?s.jsx(p.e,{content:e.comment,showArrow:!0,children:s.jsx("div",{className:"text-xs font-light",children:e.comment?.slice(0,10)})}):s.jsx("div",{className:"text-xs font-light",children:e.comment}):s.jsx(s.Fragment,{children:"-"});default:return s.jsx(s.Fragment,{})}},ed=(0,s.jsxs)(a.J,{children:[s.jsx(r.j,{children:"Player"},"player_name"),s.jsx(r.j,{children:"Status"},"status"),s.jsx(r.j,{children:"Admin"},"admin_name"),s.jsx(r.j,{children:"Type"},"type"),s.jsx(r.j,{children:"Reason"},"reason"),s.jsx(r.j,{children:"Remove Reason"},"unmute_reason"),s.jsx(r.j,{children:"Duration"},"duration"),s.jsx(r.j,{children:"Time left"},"timeLeft")]});switch(e){case"MANAGE":ed=(0,s.jsxs)(a.J,{children:[s.jsx(r.j,{children:"Player"},"player_name"),s.jsx(r.j,{children:"Status"},"status"),s.jsx(r.j,{children:"Admin"},"admin_name"),s.jsx(r.j,{children:"Type"},"type"),s.jsx(r.j,{children:"Reason"},"reason"),s.jsx(r.j,{children:"Remove Reason"},"unmute_reason"),s.jsx(r.j,{children:"Duration"},"duration"),s.jsx(r.j,{children:"Time left"},"timeLeft"),s.jsx(r.j,{children:"Comment"},"comment")]});break;case"SMALL":ed=(0,s.jsxs)(a.J,{children:[s.jsx(r.j,{children:"Player"},"player_name"),s.jsx(r.j,{children:"Status"},"status"),s.jsx(r.j,{children:"Type"},"type"),s.jsx(r.j,{children:"Reason"},"reason"),s.jsx(r.j,{children:"Duration"},"duration"),s.jsx(r.j,{children:"Time left"},"timeLeft")]});break;case"NORMAL":ed=(0,s.jsxs)(a.J,{children:[s.jsx(r.j,{children:"Player"},"player_name"),s.jsx(r.j,{children:"Status"},"status"),s.jsx(r.j,{children:"Admin"},"admin_name"),s.jsx(r.j,{children:"Type"},"type"),s.jsx(r.j,{children:"Reason"},"reason"),s.jsx(r.j,{children:"Remove Reason"},"unmute_reason"),s.jsx(r.j,{children:"Duration"},"duration"),s.jsx(r.j,{children:"Time left"},"timeLeft")]})}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.b,{topContent:(0,s.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,s.jsxs)("div",{className:"text-start",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Mutes"}),(0,s.jsxs)("code",{className:"text-sm font-normal",children:["total: ",X?.count||""]})]}),O&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(E.A,{size:"sm",variant:"flat",color:"primary",onClick:()=>n(!0),children:[s.jsx(b.Z,{}),"New mute"]}),s.jsx(V,{open:t,setOpen:n,mutate:$})]})]}),bottomContent:(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"flex w-full justify-center",children:s.jsx(h.g,{color:"primary",page:k,total:F,onChange:e=>U(e),size:"sm",isCompact:!0,showControls:!0,showShadow:!0})}),O&&"MANAGE"===e&&s.jsx("span",{className:"text-sm",children:"Tip, your can right click on a player row for more actions"})]}),children:[ed,s.jsx(l.y,{items:X?.results??[],loadingContent:s.jsx(j.c,{}),loadingState:Y?"loading":"idle",children:e=>s.jsx(o.g,{onContextMenu:t=>O&&q&&q(t,e)||void 0,children:t=>s.jsx(d.X,{children:eo(e,t)})},e.id)})]}),O&&s.jsx(L.Z,{open:H,x:G,y:W,handleCloseMenu:B,items:[{category:"Mute Actions",items:[{key:"Comment",description:"Write a comment on this mute, this will be visible to other admins",icon:w.Z,color:"default",onClick:()=>{et("comment"),es({comment:Q?.comment||""})}},{key:Q?.status==="UNMUTED"||Q?.status==="EXPIRED"?"Re-mute":"Remove Mute (shorten)",description:Q?.status==="UNMUTED"||Q?.status==="EXPIRED"?"Re-mute the player":"Remove the player mute (shorten the duration)",icon:T.Z,color:"default",onClick:()=>{Q?.status==="UNMUTED"||Q?.status==="EXPIRED"?(et("remute"),es({reason:"",duration:"0",type:"MUTE"})):(et("unmute"),es({reason:""}))}},{key:"Edit Mute",description:"Edit the mute duration or reason",icon:w.Z,color:"primary",onClick:()=>{et("edit"),es({reason:Q?.reason||"",duration:Q?.duration.toString()||"0",type:Q?.type||"MUTE"})}},{key:"Delete Mute",description:"Delete the mute from the database (permanent action)",icon:C.Z,color:"danger",onClick:()=>{et("delete")}}]}]}),O&&(0,s.jsxs)(A.Z,{open:"comment"===ee,handleClose:ei,action:el,isLoading:ea,actionText:"Save",children:[s.jsx("div",{children:"Write a comment on this mute, this will be visible to other admins"}),s.jsx(y.Y,{label:"Comment",value:en?.comment||"",onValueChange:e=>es({comment:e})})]}),O&&(0,s.jsxs)(A.Z,{open:"unmute"===ee,handleClose:ei,action:el,isLoading:ea,actionText:"Unmute",children:[s.jsx("div",{children:"You sure you want to unmute the user?"}),s.jsx(y.Y,{label:"Reason",value:en?.reason||"",onValueChange:e=>es({reason:e})})]}),O&&(0,s.jsxs)(A.Z,{open:"remute"===ee,handleClose:ei,action:el,isLoading:ea,actionText:"Remute",children:[s.jsx("div",{children:"You sure you want to remute the user?"}),s.jsx(y.Y,{label:"Reason",value:en?.reason||"",onValueChange:e=>es({...en,reason:e})}),s.jsx(m.g,{label:"Type",placeholder:"Select the mute type",selectedKeys:[en?.type],onChange:e=>es({...en,type:e.target.value}),disallowEmptySelection:!0,children:K.map(e=>s.jsx(u.R,{value:e.value,children:e.name},e.value))}),s.jsx(y.Y,{label:"Time (in minutes)",type:"number",value:en?.duration||"",onValueChange:e=>es({...en,duration:e}),description:"Time in minutes, 0 = Permanent mute"}),(0,s.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,s.jsxs)("span",{children:["The mute will start again at ",s.jsx("b",{children:(0,_.Z)()})]}),(0,s.jsxs)("span",{children:["the mute will end at"," ",s.jsx("b",{children:en?.duration==="0"?s.jsx("b",{className:"text-red-700",children:"Permanent"}):(0,_.Z)(new Date().getTime()+6e4*Number(en?.duration))})]})]})]}),O&&(0,s.jsxs)(A.Z,{open:"edit"===ee,handleClose:ei,action:el,isLoading:ea,actionText:"Edit",children:[s.jsx("div",{children:"This will replace the mute duration or reason"}),s.jsx(y.Y,{label:"Mute Reason",value:en?.reason,onValueChange:e=>es({...en,reason:e})}),s.jsx(m.g,{label:"Type",placeholder:"Select the mute type",selectedKeys:[en?.type],onChange:e=>es({...en,type:e.target.value}),disallowEmptySelection:!0,children:K.map(e=>s.jsx(u.R,{value:e.value,children:e.name},e.value))}),s.jsx(y.Y,{label:"Mute Time (in minutes)",type:"number",value:en?.duration||"",onValueChange:e=>es({...en,duration:e}),description:"Time in minutes, this will be added to the current duration, 0 = Permanent mute (will replace the duration)"}),(0,s.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,s.jsxs)("span",{children:["The mute started at ",s.jsx("b",{children:(0,_.Z)(Q?.created)})]}),(0,s.jsxs)("span",{children:["After the edit, the mute will end at"," ",s.jsx("b",{children:en?.duration==="0"?s.jsx("b",{className:"text-red-700",children:"Permanent"}):(0,_.Z)(new Date(Q?.created||"").getTime()+6e4*Number(en?.duration))})]})]})]}),O&&s.jsx(A.Z,{open:"delete"===ee,handleClose:ei,action:el,isLoading:ea,actionText:"Delete",children:s.jsx("div",{children:"Are you sure you want to delete the mute? this action is permanent and cannot be undone"})})]})}},66819:(e,t,n)=>{n.d(t,{Z:()=>s});var s=(0,n(15544).Z)("message","IconMessage",[["path",{d:"M8 9h8",key:"svg-0"}],["path",{d:"M8 13h6",key:"svg-1"}],["path",{d:"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z",key:"svg-2"}]])},11082:(e,t,n)=>{n.d(t,{Z:()=>s});let s=e=>{let t=e?new Date(e):new Date;return t.toLocaleDateString()+" - "+t.toLocaleTimeString()}},70059:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(22173);let a=()=>{let[e,t]=(0,s.useState)({open:!1,x:0,y:0,info:void 0});return{x:e.x,y:e.y,open:e.open,handleCloseMenu:()=>{t({...e,open:!1})},handleOpen:(e,n)=>{e.preventDefault();let{pageX:s,pageY:a}=e;t({open:!0,x:s,y:a,info:n})},info:e.info}}},94608:(e,t,n)=>{n.d(t,{P:()=>a,Z:()=>r});var s=n(4570);let a=s.z.enum(["GAG","MUTE","SILENCE"]),r=s.z.object({player_steamid:s.z.string(),reason:s.z.string().min(3),duration:s.z.string(),comment:s.z.string().optional(),type:a})}};