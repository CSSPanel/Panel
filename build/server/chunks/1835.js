"use strict";exports.id=1835,exports.ids=[1835],exports.modules={15688:(e,t,a)=>{a.d(t,{A:()=>m});var s=a(83223),n=a(31449),r=a(72872),i=a(99191),l=a(26324),o=a(82562);let c=(e,t)=>{(0,o.useEffect)(()=>{let a=a=>{let s=e?.current;!(!s||s?.contains(a.target))&&t(a)};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}},[e,t])};var d=a(3980);let m=({open:e,x:t,y:a,handleCloseMenu:m,items:u})=>{let h=(0,o.useRef)(null);c(h,m);let{admin:x}=(0,d.Ay)(),p=x?.flags,j=u.map(({category:e,items:t})=>({category:e,items:t.filter(({flags:e})=>!e||e.some(e=>p?.includes(e)))}));return e&&(0,s.jsx)(l.P.div,{className:"w-full max-w-[260px] border-small px-1 py-0.5 rounded-small bg-background/40 backdrop-blur-lg border-default-200 absolute z-[20000]",style:{left:t,top:a},ref:h,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.08},"aria-label":"Context menu",children:(0,s.jsx)(n.K,{variant:"flat","aria-label":"Listbox menu with sections",items:u,children:j.map(({category:e,items:t})=>(0,s.jsx)(r.K,{title:e,"aria-label":e,children:t.map(({key:e,description:t,icon:a,color:n,onClick:r})=>(0,s.jsx)(i.y,{description:(0,s.jsx)("span",{className:"text-foreground-700",children:t}),startContent:(0,s.jsx)(a,{"aria-label":e}),color:n||"default",onClick:()=>{r&&r(),m()},"aria-label":e,children:e},e))},e))})})}},39228:(e,t,a)=>{a.d(t,{A:()=>s});let s=e=>{let t=e?new Date(e):new Date;return t.toLocaleDateString()+" - "+t.toLocaleTimeString()}},44540:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(82562);let n=()=>{let[e,t]=(0,s.useState)({open:!1,x:0,y:0,info:void 0});return{x:e.x,y:e.y,open:e.open,handleCloseMenu:()=>{t({...e,open:!1})},handleOpen:(e,a)=>{e.preventDefault();let{pageX:s,pageY:n}=e;t({open:!0,x:s,y:n,info:a})},info:e.info}}},46195:(e,t,a)=>{a.d(t,{A:()=>r,m:()=>n});var s=a(46531);let n=s.z.enum(["GAG","MUTE","SILENCE"]),r=s.z.object({player_steamid:s.z.string(),reason:s.z.string().min(3),duration:s.z.string(),comment:s.z.string().optional(),type:n})},71835:(e,t,a)=>{a.d(t,{v:()=>J,default:()=>Q});var s=a(83223),n=a(70568),r=a(15626),i=a(82549),l=a(57165),o=a(1918),c=a(7693),d=a(3701),m=a(81050),u=a(37816),h=a(93391),x=a(46547),p=a(99191),j=a(8405),y=a(62059),g=a(41673),v=a(20405),f=a(18936),b=a(88751),w=a(96645),A=a(77262),T=a(82562),C=a(22762),E=a(33883),N=a(46195),D=a(9091),R=a(46531);let S=(0,D.vt)(e=>({action:null,setAction:t=>e({action:t}),isLoading:!1,setIsLoading:t=>e({isLoading:t}),details:null,setDetails:t=>e({details:t}),reset:()=>e({action:null,isLoading:!1,details:null})}));R.z.object({reason:R.z.string()}),R.z.object({reason:R.z.string(),duration:R.z.string(),type:N.m}),R.z.object({comment:R.z.string()}),R.z.object({reason:R.z.string(),duration:R.z.string(),type:N.m}),R.z.enum(["unmute","remute","comment","edit","delete"]);var M=a(39228),P=a(90314),_=a(44540),z=a(15688),L=a(3980),I=a(74549),k=a(45034),U=a(65151),X=a(9032),$=a(5289),V=a(549),F=a(25615),G=a(19206),O=a(68458),K=a(61571);let Y=({open:e,setOpen:t,mutate:a})=>{let[n,r]=(0,T.useState)(!1),i=async()=>{if(!n){r(!0);try{await (0,K.A)("/api/mutes",{method:"POST",data:l.values}),await a(),k.oR.success("Succesfully muted player!"),t(!1)}catch(t){let e=t?.response?.data||t?.message;console.error(t),k.oR.error(`Failed to create mute!
${e||t}`)}r(!1)}},l=(0,U.m)({initialValues:{player_steamid:"",reason:"",duration:"",comment:"",type:"MUTE"},validate:(0,X.u)(N.A)});return(0,s.jsx)($.Y,{isOpen:e,onOpenChange:n?void 0:t,children:(0,s.jsx)(V.g,{children:e=>(0,s.jsxs)("form",{onSubmit:l.onSubmit(i),children:[(0,s.jsx)(F.c,{className:"flex flex-col gap-1",children:"Create new mute"}),(0,s.jsxs)(G.h,{children:[(0,s.jsx)(A.r,{...l.getInputProps("player_steamid"),errorMessage:l.errors.player_steamid,isInvalid:!!l.errors.player_steamid,label:"Player Steam64 / SteamId / Profile URL",placeholder:"7656XXXXXX",variant:"bordered",isDisabled:n,autoFocus:!0}),(0,s.jsx)(x.d,{label:"Type",placeholder:"Select the mute type",selectedKeys:[l.values.type],onChange:e=>l.setValues({type:e.target.value}),isDisabled:n,disallowEmptySelection:!0,children:J.map(e=>(0,s.jsx)(p.y,{value:e.value,children:e.name},e.value))}),(0,s.jsx)(A.r,{...l.getInputProps("reason"),errorMessage:l.errors.reason,isInvalid:!!l.errors.reason,label:"Reason (min 3 characters)",placeholder:"Cheating / Griefing / Toxicity / etc.",variant:"bordered",isDisabled:n}),(0,s.jsx)(A.r,{...l.getInputProps("duration"),errorMessage:l.errors.duration,isInvalid:!!l.errors.duration,label:"Duration in minutes",placeholder:"for example, 60",description:"0 for permanent",variant:"bordered",type:"number",isDisabled:n}),(0,s.jsx)(A.r,{...l.getInputProps("comment"),errorMessage:l.errors.comment,isInvalid:!!l.errors.comment,label:"Comment (optional)",variant:"bordered",isDisabled:n}),(0,s.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,s.jsxs)("span",{children:["The mute will start now ",(0,s.jsxs)("b",{children:["(",(0,M.A)(),")"]})]}),(0,s.jsxs)("span",{children:["and will end at"," ",(0,s.jsx)("b",{children:"0"===l.values.duration?(0,s.jsx)("b",{className:"text-red-700",children:"Permanent"}):(0,M.A)(new Date().getTime()+6e4*Number(l.values.duration))})]})]})]}),(0,s.jsxs)(O.q,{children:[(0,s.jsx)(b.T,{color:"danger",variant:"flat",onPress:e,isDisabled:n,children:"Cancel"}),(0,s.jsx)(b.T,{color:"primary",type:"submit",isLoading:n,children:"Mute player"})]})]})})})},q=e=>{switch(e){case"ACTIVE":return(0,s.jsx)(E.R,{color:"danger",size:"sm",variant:"flat",radius:"sm",children:"Active"});case"EXPIRED":return(0,s.jsx)(E.R,{color:"success",size:"sm",variant:"flat",radius:"sm",children:"Expired"});case"UNMUTED":return(0,s.jsx)(E.R,{color:"secondary",size:"sm",variant:"flat",radius:"sm",children:"Removed"});default:return(0,s.jsx)(E.R,{color:"secondary",size:"sm",variant:"flat",radius:"sm",children:"Unknown"})}};var W=a(97598),H=a.n(W),B=a(34438);let J=[{name:"Gag (Chat)",value:"GAG"},{name:"Mute (Voice)",value:"MUTE"},{name:"Silence (Both)",value:"SILENCE"}],Q=({type:e})=>{let[t,a]=(0,T.useState)(!1),[N,D]=(0,T.useState)(1),[R,U]=(0,T.useState)(""),[X]=(0,w.d7)(R,500),$=10;"/"===(0,v.usePathname)()&&($=5);let{data:V,isLoading:F,mutate:G}=(0,B.Ay)(`/api/mutes?page=${N}&rows=${$}&query=${X}`,I.A,{keepPreviousData:!0}),O=(0,T.useMemo)(()=>V?.count?Math.ceil(V.count/$):0,[V?.count,$]),{admin:W}=(0,L.Ay)(),{x:Q,y:Z,open:ee,handleCloseMenu:et,handleOpen:ea,info:es}=(0,_.A)(),en=S(e=>e.action),er=S(e=>e.setAction),ei=S(e=>e.details),el=S(e=>e.setDetails),eo=S(e=>e.isLoading),ec=S(e=>e.setIsLoading),ed=S(e=>e.reset),em=async()=>{if(en&&!eo&&es){ec(!0);try{await K.A.post(`/api/mutes/${es.id}`,{action:en,details:ei}),await G(),ed(),k.Ay.success(`Player ${en}ed successfully`)}catch(e){k.Ay.error(`Error ${en} player`)}ec(!1)}},eu=(e,t)=>{switch(t){case"player_name":return(0,s.jsx)(H(),{href:`https://steamcommunity.com/profiles/${e.player_steamid}`,target:"_blank",passHref:!0,children:(0,s.jsx)(C.S,{avatarProps:{radius:"lg",src:e.player_avatar||""},name:e.player_name,children:e.player_name?.slice(0,10)})});case"status":return q(e.status);case"reason":return e.reason.length>10?(0,s.jsx)(f.I,{content:e.reason,"aria-label":e.reason,showArrow:!0,children:(0,s.jsx)("div",{className:"text-xs font-light",children:e.reason.slice(0,10)})}):(0,s.jsx)("div",{className:"text-xs font-light",children:e.reason});case"unmute_reason":return e.unmute_reason&&e.unmute_reason.length>10?(0,s.jsx)(f.I,{content:e.unmute_reason,"aria-label":e.unmute_reason,showArrow:!0,children:(0,s.jsx)("div",{className:"text-xs font-light",children:e.unmute_reason?.slice(0,10)})}):(0,s.jsx)("div",{className:"text-xs font-light",children:e.unmute_reason});case"type":return(0,s.jsx)(E.R,{color:"secondary",size:"sm",variant:"flat",radius:"sm",children:e.type});case"duration":return(0,s.jsx)(E.R,{color:"primary",size:"sm",variant:"flat",radius:"sm",children:0===e.duration?"Permanent":`${e.duration} minutes`});case"admin_name":return e.admin_name?"Console"===e.admin_name?(0,s.jsx)(E.R,{color:"danger",size:"sm",variant:"flat",radius:"sm",children:"Console"}):(0,s.jsx)(H(),{href:`https://steamcommunity.com/profiles/${e.admin_steamid}`,target:"_blank",passHref:!0,children:(0,s.jsx)(C.S,{avatarProps:{radius:"lg",src:e.admin_avatar||""},name:e.admin_name,children:e.admin_name})}):(0,s.jsx)(s.Fragment,{children:"-"});case"timeLeft":if(0===e.duration)return(0,s.jsx)(E.R,{color:"danger",size:"sm",variant:"flat",radius:"sm",children:"Permanent"});if("UNMUTED"===e.status||"EXPIRED"===e.status)return(0,s.jsx)(y.o,{color:"success",value:100,"aria-label":"Expired"});let a=new Date,n=new Date(e.created),r=new Date(e.ends),i=Math.round((a.getTime()-n.getTime())/(r.getTime()-n.getTime())*100)||0,l=Math.round((r.getTime()-a.getTime())/6e4),o=i<50?"warning":i>=100?"success":"primary";return l>0?(0,s.jsx)(f.I,{content:`${l} minutes left`,color:o,"aria-label":`${l} minutes left`,showArrow:!0,children:(0,s.jsx)(y.o,{color:o,value:i,"aria-label":`${l} minutes left`})}):(0,s.jsx)(y.o,{color:o,value:i,"aria-label":"Expired"});case"comment":return e.comment?e.comment.length>10?(0,s.jsx)(f.I,{content:e.comment,"aria-label":e.comment,showArrow:!0,children:(0,s.jsx)("div",{className:"text-xs font-light",children:e.comment?.slice(0,10)})}):(0,s.jsx)("div",{className:"text-xs font-light",children:e.comment}):(0,s.jsx)(s.Fragment,{children:"-"});case"created":return(0,M.A)(e.created);default:return(0,s.jsx)(s.Fragment,{})}},eh=(0,s.jsx)(s.Fragment,{});switch(e){case"MANAGE":eh=(0,s.jsxs)(n.X,{children:[(0,s.jsx)(r.e,{children:"Player"},"player_name"),(0,s.jsx)(r.e,{children:"Status"},"status"),(0,s.jsx)(r.e,{children:"Admin"},"admin_name"),(0,s.jsx)(r.e,{children:"Type"},"type"),(0,s.jsx)(r.e,{children:"Reason"},"reason"),(0,s.jsx)(r.e,{children:"Remove Reason"},"unmute_reason"),(0,s.jsx)(r.e,{children:"Duration"},"duration"),(0,s.jsx)(r.e,{children:"Time left"},"timeLeft"),(0,s.jsx)(r.e,{children:"Comment"},"comment")]});break;case"SMALL":eh=(0,s.jsxs)(n.X,{children:[(0,s.jsx)(r.e,{children:"Player"},"player_name"),(0,s.jsx)(r.e,{children:"Status"},"status"),(0,s.jsx)(r.e,{children:"Type"},"type"),(0,s.jsx)(r.e,{children:"Reason"},"reason"),(0,s.jsx)(r.e,{children:"Duration"},"duration"),(0,s.jsx)(r.e,{children:"Time left"},"timeLeft")]});break;case"NORMAL":eh=(0,s.jsxs)(n.X,{children:[(0,s.jsx)(r.e,{children:"Player"},"player_name"),(0,s.jsx)(r.e,{children:"Status"},"status"),(0,s.jsx)(r.e,{children:"Admin"},"admin_name"),(0,s.jsx)(r.e,{children:"Type"},"type"),(0,s.jsx)(r.e,{children:"Reason"},"reason"),(0,s.jsx)(r.e,{children:"Remove Reason"},"unmute_reason"),(0,s.jsx)(r.e,{children:"Duration"},"duration"),(0,s.jsx)(r.e,{children:"Time left"},"timeLeft")]})}let ex=["@css/generic","@css/root","@web/mutes"],ep=W?.flags?.some(e=>ex.includes(e))||!1;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.j,{topContent:(0,s.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,s.jsxs)("div",{className:"text-start",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Mutes"}),(0,s.jsxs)("code",{className:"text-sm font-normal",children:["total: ",V?.count||""]})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(f.I,{content:"Search for player name, steamid, IP, reason, etc.",closeDelay:50,color:"primary",delay:400,"aria-label":"Search for player name, steamid, IP, reason, etc.",children:(0,s.jsx)(A.r,{label:"Search",labelPlacement:"outside-left",value:R,onValueChange:U,size:"sm",classNames:{mainWrapper:"h-fit",base:"h-fit"},isClearable:!0})}),W&&ep&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(b.T,{size:"sm",variant:"flat",color:"primary",onClick:()=>a(!0),children:[(0,s.jsx)(d.A,{size:46}),"New mute"]}),(0,s.jsx)(Y,{open:t,setOpen:a,mutate:G})]})]})]}),bottomContent:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex w-full justify-center",children:(0,s.jsx)(j.T,{color:"primary",page:N,total:O,onChange:e=>D(e),size:"sm",isCompact:!0,showControls:!0,showShadow:!0})}),W&&"MANAGE"===e&&(0,s.jsx)("span",{className:"text-sm",children:"Tip, your can right click on a player row for more actions"})]}),children:[eh,(0,s.jsx)(l.E,{items:V?.results??[],loadingContent:(0,s.jsx)(g.o,{}),loadingState:F?"loading":"idle",children:e=>(0,s.jsx)(o.s,{onContextMenu:t=>W&&ea&&ea(t,e)||void 0,children:t=>(0,s.jsx)(c.w,{children:eu(e,t)})},e.id)})]}),W&&(0,s.jsx)(z.A,{open:ee,x:Q,y:Z,handleCloseMenu:et,items:[{category:"Mute Actions",items:[{key:"Comment",description:"Write a comment on this mute, this will be visible to other admins",icon:m.A,color:"default",onClick:()=>{er("comment"),el({comment:es?.comment||""})},flags:["@css/root","@web/mutes","@web/root"]},{key:es?.status==="UNMUTED"||es?.status==="EXPIRED"?"Re-mute":"Remove Mute (shorten)",description:es?.status==="UNMUTED"||es?.status==="EXPIRED"?"Re-mute the player":"Remove the player mute (shorten the duration)",icon:u.A,color:"default",onClick:()=>{es?.status==="UNMUTED"||es?.status==="EXPIRED"?(er("remute"),el({reason:"",duration:"0",type:"MUTE"})):(er("unmute"),el({reason:""}))},flags:["@css/root","@web/mutes","@web/root"]},{key:"Edit Mute",description:"Edit the mute duration or reason",icon:m.A,color:"primary",onClick:()=>{er("edit"),el({reason:es?.reason||"",duration:es?.duration.toString()||"0",type:es?.type||"MUTE"})},flags:["@css/root","@web/mutes","@web/root"]},{key:"Delete Mute",description:"Delete the mute from the database (permanent action)",icon:h.A,color:"danger",onClick:()=>{er("delete")},flags:["@css/root","@web/mutes","@web/root"]}]}]}),W&&(0,s.jsxs)(P.A,{open:"comment"===en,handleClose:ed,action:em,isLoading:eo,actionText:"Save",children:[(0,s.jsx)("div",{children:"Write a comment on this mute, this will be visible to other admins"}),(0,s.jsx)(A.r,{label:"Comment",value:ei?.comment||"",onValueChange:e=>el({comment:e})})]}),W&&(0,s.jsxs)(P.A,{open:"unmute"===en,handleClose:ed,action:em,isLoading:eo,actionText:"Unmute",children:[(0,s.jsx)("div",{children:"You sure you want to unmute the user?"}),(0,s.jsx)(A.r,{label:"Reason",value:ei?.reason||"",onValueChange:e=>el({reason:e})})]}),W&&(0,s.jsxs)(P.A,{open:"remute"===en,handleClose:ed,action:em,isLoading:eo,actionText:"Remute",children:[(0,s.jsx)("div",{children:"You sure you want to remute the user?"}),(0,s.jsx)(A.r,{label:"Reason",value:ei?.reason||"",onValueChange:e=>el({...ei,reason:e})}),(0,s.jsx)(x.d,{label:"Type",placeholder:"Select the mute type",selectedKeys:[ei?.type],onChange:e=>el({...ei,type:e.target.value}),disallowEmptySelection:!0,children:J.map(e=>(0,s.jsx)(p.y,{value:e.value,children:e.name},e.value))}),(0,s.jsx)(A.r,{label:"Time (in minutes)",type:"number",value:ei?.duration||"",onValueChange:e=>el({...ei,duration:e}),description:"Time in minutes, 0 = Permanent mute"}),(0,s.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,s.jsxs)("span",{children:["The mute will start again at ",(0,s.jsx)("b",{children:(0,M.A)()})]}),(0,s.jsxs)("span",{children:["the mute will end at"," ",(0,s.jsx)("b",{children:ei?.duration==="0"?(0,s.jsx)("b",{className:"text-red-700",children:"Permanent"}):(0,M.A)(new Date().getTime()+6e4*Number(ei?.duration))})]})]})]}),W&&(0,s.jsxs)(P.A,{open:"edit"===en,handleClose:ed,action:em,isLoading:eo,actionText:"Edit",children:[(0,s.jsx)("div",{children:"This will replace the mute duration or reason"}),(0,s.jsx)(A.r,{label:"Mute Reason",value:ei?.reason,onValueChange:e=>el({...ei,reason:e})}),(0,s.jsx)(x.d,{label:"Type",placeholder:"Select the mute type",selectedKeys:[ei?.type],onChange:e=>el({...ei,type:e.target.value}),disallowEmptySelection:!0,children:J.map(e=>(0,s.jsx)(p.y,{value:e.value,children:e.name},e.value))}),(0,s.jsx)(A.r,{label:"Mute Time (in minutes)",type:"number",value:ei?.duration||"",onValueChange:e=>el({...ei,duration:e}),description:"Time in minutes, this will be added to the current duration, 0 = Permanent mute (will replace the duration)"}),(0,s.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,s.jsxs)("span",{children:["The mute started at ",(0,s.jsx)("b",{children:(0,M.A)(es?.created)})]}),(0,s.jsxs)("span",{children:["After the edit, the mute will end at"," ",(0,s.jsx)("b",{children:ei?.duration==="0"?(0,s.jsx)("b",{className:"text-red-700",children:"Permanent"}):(0,M.A)(new Date(es?.created||"").getTime()+6e4*Number(ei?.duration))})]})]})]}),W&&(0,s.jsx)(P.A,{open:"delete"===en,handleClose:ed,action:em,isLoading:eo,actionText:"Delete",children:(0,s.jsx)("div",{children:"Are you sure you want to delete the mute? this action is permanent and cannot be undone"})})]})}},90314:(e,t,a)=>{a.d(t,{A:()=>d});var s=a(83223),n=a(5289),r=a(549),i=a(25615),l=a(19206),o=a(68458),c=a(88751);let d=({open:e,children:t,action:a,handleClose:d,isLoading:m,actionText:u})=>(0,s.jsx)(n.Y,{isOpen:e,onOpenChange:!m&&d||void 0,classNames:{backdrop:"z-[20000]",wrapper:"z-[20000]"},children:(0,s.jsx)(r.g,{children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.c,{className:"flex flex-col gap-1",children:"Confirmation"}),(0,s.jsx)(l.h,{children:t}),(0,s.jsxs)(o.q,{children:[(0,s.jsx)(c.T,{color:"primary",variant:"light",onPress:e,isLoading:m,children:"Cancel"}),(0,s.jsx)(c.T,{color:"primary",onPress:a,isLoading:m,children:u||"Confirm"})]})]})})})}};